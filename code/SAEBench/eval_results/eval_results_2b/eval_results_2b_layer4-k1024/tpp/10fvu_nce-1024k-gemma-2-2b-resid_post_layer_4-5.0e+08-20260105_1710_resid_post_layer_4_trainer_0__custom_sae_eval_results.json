{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "83f64761-fa1d-47a6-a454-7ff3e7b9701b",
  "datetime_epoch_millis": 1767673824153,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.008574996888637543,
      "tpp_threshold_2_intended_diff_only": 0.009600001573562621,
      "tpp_threshold_2_unintended_diff_only": 0.0010250046849250793,
      "tpp_threshold_5_total_metric": 0.012450005114078521,
      "tpp_threshold_5_intended_diff_only": 0.013300013542175294,
      "tpp_threshold_5_unintended_diff_only": 0.0008500084280967712,
      "tpp_threshold_10_total_metric": 0.025474996864795686,
      "tpp_threshold_10_intended_diff_only": 0.027900004386901857,
      "tpp_threshold_10_unintended_diff_only": 0.0024250075221061707,
      "tpp_threshold_20_total_metric": 0.03525000661611557,
      "tpp_threshold_20_intended_diff_only": 0.03830001354217529,
      "tpp_threshold_20_unintended_diff_only": 0.003050006926059723,
      "tpp_threshold_50_total_metric": 0.06852500438690184,
      "tpp_threshold_50_intended_diff_only": 0.07320001125335693,
      "tpp_threshold_50_unintended_diff_only": 0.0046750068664550785,
      "tpp_threshold_100_total_metric": 0.1133250117301941,
      "tpp_threshold_100_intended_diff_only": 0.12040001153945923,
      "tpp_threshold_100_unintended_diff_only": 0.007074999809265137,
      "tpp_threshold_500_total_metric": 0.3587250217795372,
      "tpp_threshold_500_intended_diff_only": 0.37290002703666686,
      "tpp_threshold_500_unintended_diff_only": 0.01417500525712967
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.005049991607666016,
      "tpp_threshold_2_intended_diff_only": 0.007200002670288086,
      "tpp_threshold_2_unintended_diff_only": 0.00215001106262207,
      "tpp_threshold_5_total_metric": 0.009049996733665466,
      "tpp_threshold_5_intended_diff_only": 0.010000014305114746,
      "tpp_threshold_5_unintended_diff_only": 0.0009500175714492798,
      "tpp_threshold_10_total_metric": 0.01990000009536743,
      "tpp_threshold_10_intended_diff_only": 0.022000014781951904,
      "tpp_threshold_10_unintended_diff_only": 0.0021000146865844727,
      "tpp_threshold_20_total_metric": 0.032349994778633116,
      "tpp_threshold_20_intended_diff_only": 0.035400009155273436,
      "tpp_threshold_20_unintended_diff_only": 0.00305001437664032,
      "tpp_threshold_50_total_metric": 0.06304999589920043,
      "tpp_threshold_50_intended_diff_only": 0.06700000762939454,
      "tpp_threshold_50_unintended_diff_only": 0.003950011730194092,
      "tpp_threshold_100_total_metric": 0.10900001525878907,
      "tpp_threshold_100_intended_diff_only": 0.11420001983642578,
      "tpp_threshold_100_unintended_diff_only": 0.005200004577636719,
      "tpp_threshold_500_total_metric": 0.3887000262737274,
      "tpp_threshold_500_intended_diff_only": 0.3954000353813171,
      "tpp_threshold_500_unintended_diff_only": 0.006700009107589722
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.01210000216960907,
      "tpp_threshold_2_intended_diff_only": 0.012000000476837159,
      "tpp_threshold_2_unintended_diff_only": -0.00010000169277191162,
      "tpp_threshold_5_total_metric": 0.015850013494491576,
      "tpp_threshold_5_intended_diff_only": 0.01660001277923584,
      "tpp_threshold_5_unintended_diff_only": 0.0007499992847442627,
      "tpp_threshold_10_total_metric": 0.03104999363422394,
      "tpp_threshold_10_intended_diff_only": 0.03379999399185181,
      "tpp_threshold_10_unintended_diff_only": 0.0027500003576278686,
      "tpp_threshold_20_total_metric": 0.03815001845359802,
      "tpp_threshold_20_intended_diff_only": 0.04120001792907715,
      "tpp_threshold_20_unintended_diff_only": 0.003049999475479126,
      "tpp_threshold_50_total_metric": 0.07400001287460327,
      "tpp_threshold_50_intended_diff_only": 0.07940001487731933,
      "tpp_threshold_50_unintended_diff_only": 0.0054000020027160645,
      "tpp_threshold_100_total_metric": 0.11765000820159913,
      "tpp_threshold_100_intended_diff_only": 0.12660000324249268,
      "tpp_threshold_100_unintended_diff_only": 0.008949995040893555,
      "tpp_threshold_500_total_metric": 0.328750017285347,
      "tpp_threshold_500_intended_diff_only": 0.3504000186920166,
      "tpp_threshold_500_unintended_diff_only": 0.021650001406669617
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "10fvu_nce-1024k-gemma-2-2b-resid_post_layer_4-5.0e+08-20260105_1710_resid_post_layer_4/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 18432,
    "hook_layer": 4,
    "hook_name": "blocks.4.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0034999996423721313,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_5_total_metric": 0.011750012636184692,
        "tpp_threshold_5_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_5_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_10_total_metric": 0.02150002121925354,
        "tpp_threshold_10_intended_diff_only": 0.025000035762786865,
        "tpp_threshold_10_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_20_total_metric": 0.04649999737739563,
        "tpp_threshold_20_intended_diff_only": 0.050000011920928955,
        "tpp_threshold_20_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_50_total_metric": 0.08100003004074097,
        "tpp_threshold_50_intended_diff_only": 0.08600002527236938,
        "tpp_threshold_50_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_100_total_metric": 0.12900005280971527,
        "tpp_threshold_100_intended_diff_only": 0.1350000500679016,
        "tpp_threshold_100_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_500_total_metric": 0.4065000116825104,
        "tpp_threshold_500_intended_diff_only": 0.41100001335144043,
        "tpp_threshold_500_unintended_diff_only": 0.004500001668930054
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.013999968767166138,
        "tpp_threshold_2_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_2_unintended_diff_only": 0.0010000169277191162,
        "tpp_threshold_5_total_metric": 0.019499972462654114,
        "tpp_threshold_5_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_5_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_10_total_metric": 0.034999996423721313,
        "tpp_threshold_10_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_10_unintended_diff_only": 0.0010000169277191162,
        "tpp_threshold_20_total_metric": 0.04349999129772186,
        "tpp_threshold_20_intended_diff_only": 0.04500001668930054,
        "tpp_threshold_20_unintended_diff_only": 0.0015000253915786743,
        "tpp_threshold_50_total_metric": 0.07349996268749237,
        "tpp_threshold_50_intended_diff_only": 0.07999998331069946,
        "tpp_threshold_50_unintended_diff_only": 0.006500020623207092,
        "tpp_threshold_100_total_metric": 0.11775000393390656,
        "tpp_threshold_100_intended_diff_only": 0.12400001287460327,
        "tpp_threshold_100_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_500_total_metric": 0.4090000092983246,
        "tpp_threshold_500_intended_diff_only": 0.4150000214576721,
        "tpp_threshold_500_unintended_diff_only": 0.006000012159347534
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.008000001311302185,
        "tpp_threshold_2_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_2_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_5_total_metric": 0.01124998927116394,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": 0.0017500221729278564,
        "tpp_threshold_10_total_metric": 0.03349997103214264,
        "tpp_threshold_10_intended_diff_only": 0.03700000047683716,
        "tpp_threshold_10_unintended_diff_only": 0.003500029444694519,
        "tpp_threshold_20_total_metric": 0.04674997925758362,
        "tpp_threshold_20_intended_diff_only": 0.050999999046325684,
        "tpp_threshold_20_unintended_diff_only": 0.004250019788742065,
        "tpp_threshold_50_total_metric": 0.08174997568130493,
        "tpp_threshold_50_intended_diff_only": 0.08300000429153442,
        "tpp_threshold_50_unintended_diff_only": 0.0012500286102294922,
        "tpp_threshold_100_total_metric": 0.15650002658367157,
        "tpp_threshold_100_intended_diff_only": 0.1640000343322754,
        "tpp_threshold_100_unintended_diff_only": 0.007500007748603821,
        "tpp_threshold_500_total_metric": 0.40775004029273987,
        "tpp_threshold_500_intended_diff_only": 0.41700005531311035,
        "tpp_threshold_500_unintended_diff_only": 0.009250015020370483
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0014999955892562866,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_5_total_metric": 0.004249989986419678,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": -0.0012499690055847168,
        "tpp_threshold_10_total_metric": 0.004500001668930054,
        "tpp_threshold_10_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": -0.0004999935626983643,
        "tpp_threshold_20_total_metric": 0.0015000104904174805,
        "tpp_threshold_20_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_20_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_50_total_metric": 0.00599999725818634,
        "tpp_threshold_50_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_50_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_100_total_metric": 0.014749974012374878,
        "tpp_threshold_100_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_100_unintended_diff_only": -0.0007499754428863525,
        "tpp_threshold_500_total_metric": 0.2772500216960907,
        "tpp_threshold_500_intended_diff_only": 0.2800000309944153,
        "tpp_threshold_500_unintended_diff_only": 0.002750009298324585
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0017500072717666626,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_5_total_metric": -0.0014999806880950928,
        "tpp_threshold_5_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_5_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_10_total_metric": 0.005000010132789612,
        "tpp_threshold_10_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_10_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_20_total_metric": 0.023499995470046997,
        "tpp_threshold_20_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_20_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_50_total_metric": 0.07300001382827759,
        "tpp_threshold_50_intended_diff_only": 0.07700002193450928,
        "tpp_threshold_50_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_100_total_metric": 0.12700001895427704,
        "tpp_threshold_100_intended_diff_only": 0.1340000033378601,
        "tpp_threshold_100_unintended_diff_only": 0.006999984383583069,
        "tpp_threshold_500_total_metric": 0.44300004839897156,
        "tpp_threshold_500_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_500_unintended_diff_only": 0.011000007390975952
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.00925000011920929,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": -0.00024999678134918213,
        "tpp_threshold_5_total_metric": 0.004250049591064453,
        "tpp_threshold_5_intended_diff_only": 0.006000041961669922,
        "tpp_threshold_5_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_10_total_metric": 0.006000027060508728,
        "tpp_threshold_10_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_10_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_20_total_metric": 0.01175004243850708,
        "tpp_threshold_20_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_20_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_50_total_metric": 0.03600005805492401,
        "tpp_threshold_50_intended_diff_only": 0.03800004720687866,
        "tpp_threshold_50_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_100_total_metric": 0.06200003623962402,
        "tpp_threshold_100_intended_diff_only": 0.06700003147125244,
        "tpp_threshold_100_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_500_total_metric": 0.29850007593631744,
        "tpp_threshold_500_intended_diff_only": 0.3190000653266907,
        "tpp_threshold_500_unintended_diff_only": 0.02049998939037323
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.012749969959259033,
        "tpp_threshold_2_intended_diff_only": 0.011999964714050293,
        "tpp_threshold_2_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_5_total_metric": 0.017499998211860657,
        "tpp_threshold_5_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_5_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_10_total_metric": 0.040249988436698914,
        "tpp_threshold_10_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_10_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_20_total_metric": 0.03825002908706665,
        "tpp_threshold_20_intended_diff_only": 0.04000002145767212,
        "tpp_threshold_20_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_50_total_metric": 0.06374998390674591,
        "tpp_threshold_50_intended_diff_only": 0.06999999284744263,
        "tpp_threshold_50_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_100_total_metric": 0.11274999380111694,
        "tpp_threshold_100_intended_diff_only": 0.12099999189376831,
        "tpp_threshold_100_unintended_diff_only": 0.008249998092651367,
        "tpp_threshold_500_total_metric": 0.3422499895095825,
        "tpp_threshold_500_intended_diff_only": 0.3569999933242798,
        "tpp_threshold_500_unintended_diff_only": 0.014750003814697266
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.010499998927116394,
        "tpp_threshold_2_intended_diff_only": -0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_5_total_metric": -0.0007499903440475464,
        "tpp_threshold_5_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": -0.003250017762184143,
        "tpp_threshold_10_total_metric": 0.011999979615211487,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_20_total_metric": 0.006750002503395081,
        "tpp_threshold_20_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_20_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_50_total_metric": 0.042000025510787964,
        "tpp_threshold_50_intended_diff_only": 0.04000002145767212,
        "tpp_threshold_50_unintended_diff_only": -0.0020000040531158447,
        "tpp_threshold_100_total_metric": 0.07575000822544098,
        "tpp_threshold_100_intended_diff_only": 0.07899999618530273,
        "tpp_threshold_100_unintended_diff_only": 0.0032499879598617554,
        "tpp_threshold_500_total_metric": 0.33150002360343933,
        "tpp_threshold_500_intended_diff_only": 0.35500001907348633,
        "tpp_threshold_500_unintended_diff_only": 0.023499995470046997
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.0377500057220459,
        "tpp_threshold_2_intended_diff_only": 0.03700000047683716,
        "tpp_threshold_2_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_5_total_metric": 0.04124997556209564,
        "tpp_threshold_5_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_5_unintended_diff_only": 0.0007500201463699341,
        "tpp_threshold_10_total_metric": 0.052999988198280334,
        "tpp_threshold_10_intended_diff_only": 0.0559999942779541,
        "tpp_threshold_10_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_20_total_metric": 0.0794999748468399,
        "tpp_threshold_20_intended_diff_only": 0.08499997854232788,
        "tpp_threshold_20_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_50_total_metric": 0.12349995970726013,
        "tpp_threshold_50_intended_diff_only": 0.13199996948242188,
        "tpp_threshold_50_unintended_diff_only": 0.008500009775161743,
        "tpp_threshold_100_total_metric": 0.18599998950958252,
        "tpp_threshold_100_intended_diff_only": 0.19599997997283936,
        "tpp_threshold_100_unintended_diff_only": 0.009999990463256836,
        "tpp_threshold_500_total_metric": 0.3579999804496765,
        "tpp_threshold_500_intended_diff_only": 0.38099998235702515,
        "tpp_threshold_500_unintended_diff_only": 0.023000001907348633
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.011250033974647522,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_5_total_metric": 0.01700003445148468,
        "tpp_threshold_5_intended_diff_only": 0.016000032424926758,
        "tpp_threshold_5_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_10_total_metric": 0.04399998486042023,
        "tpp_threshold_10_intended_diff_only": 0.05199998617172241,
        "tpp_threshold_10_unintended_diff_only": 0.008000001311302185,
        "tpp_threshold_20_total_metric": 0.054500043392181396,
        "tpp_threshold_20_intended_diff_only": 0.06200003623962402,
        "tpp_threshold_20_unintended_diff_only": 0.007499992847442627,
        "tpp_threshold_50_total_metric": 0.10475003719329834,
        "tpp_threshold_50_intended_diff_only": 0.1170000433921814,
        "tpp_threshold_50_unintended_diff_only": 0.012250006198883057,
        "tpp_threshold_100_total_metric": 0.15175001323223114,
        "tpp_threshold_100_intended_diff_only": 0.17000001668930054,
        "tpp_threshold_100_unintended_diff_only": 0.018250003457069397,
        "tpp_threshold_500_total_metric": 0.3135000169277191,
        "tpp_threshold_500_intended_diff_only": 0.3400000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.026500016450881958
      }
    }
  }
}