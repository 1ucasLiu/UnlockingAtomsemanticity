{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "1f99a198-7bec-4ed0-b757-1dbb621a1932",
  "datetime_epoch_millis": 1766897714008,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0031250029802322387,
      "tpp_threshold_2_intended_diff_only": 0.003800010681152344,
      "tpp_threshold_2_unintended_diff_only": 0.000675007700920105,
      "tpp_threshold_5_total_metric": 0.004475009441375733,
      "tpp_threshold_5_intended_diff_only": 0.004300016164779663,
      "tpp_threshold_5_unintended_diff_only": -0.00017499327659606931,
      "tpp_threshold_10_total_metric": 0.012599995732307434,
      "tpp_threshold_10_intended_diff_only": 0.013700002431869506,
      "tpp_threshold_10_unintended_diff_only": 0.001100006699562073,
      "tpp_threshold_20_total_metric": 0.01207500547170639,
      "tpp_threshold_20_intended_diff_only": 0.012700009346008302,
      "tpp_threshold_20_unintended_diff_only": 0.0006250038743019104,
      "tpp_threshold_50_total_metric": 0.022000007331371307,
      "tpp_threshold_50_intended_diff_only": 0.02250000834465027,
      "tpp_threshold_50_unintended_diff_only": 0.0005000010132789612,
      "tpp_threshold_100_total_metric": 0.03087499588727951,
      "tpp_threshold_100_intended_diff_only": 0.03270000219345093,
      "tpp_threshold_100_unintended_diff_only": 0.0018250063061714173,
      "tpp_threshold_500_total_metric": 0.08802499175071717,
      "tpp_threshold_500_intended_diff_only": 0.0915000021457672,
      "tpp_threshold_500_unintended_diff_only": 0.003475010395050049
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.002650013566017151,
      "tpp_threshold_2_intended_diff_only": 0.004600024223327637,
      "tpp_threshold_2_unintended_diff_only": 0.0019500106573104858,
      "tpp_threshold_5_total_metric": 0.006350016593933106,
      "tpp_threshold_5_intended_diff_only": 0.007200026512145996,
      "tpp_threshold_5_unintended_diff_only": 0.0008500099182128906,
      "tpp_threshold_10_total_metric": 0.011749997735023499,
      "tpp_threshold_10_intended_diff_only": 0.013200008869171142,
      "tpp_threshold_10_unintended_diff_only": 0.0014500111341476441,
      "tpp_threshold_20_total_metric": 0.015300002694129945,
      "tpp_threshold_20_intended_diff_only": 0.017200016975402833,
      "tpp_threshold_20_unintended_diff_only": 0.0019000142812728882,
      "tpp_threshold_50_total_metric": 0.024050021171569826,
      "tpp_threshold_50_intended_diff_only": 0.02620002031326294,
      "tpp_threshold_50_unintended_diff_only": 0.0021499991416931152,
      "tpp_threshold_100_total_metric": 0.036650002002716064,
      "tpp_threshold_100_intended_diff_only": 0.039200007915496826,
      "tpp_threshold_100_unintended_diff_only": 0.0025500059127807617,
      "tpp_threshold_500_total_metric": 0.09814999103546143,
      "tpp_threshold_500_intended_diff_only": 0.1002000093460083,
      "tpp_threshold_500_unintended_diff_only": 0.002050018310546875
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0035999923944473266,
      "tpp_threshold_2_intended_diff_only": 0.0029999971389770507,
      "tpp_threshold_2_unintended_diff_only": -0.0005999952554702759,
      "tpp_threshold_5_total_metric": 0.0026000022888183595,
      "tpp_threshold_5_intended_diff_only": 0.0014000058174133301,
      "tpp_threshold_5_unintended_diff_only": -0.0011999964714050292,
      "tpp_threshold_10_total_metric": 0.01344999372959137,
      "tpp_threshold_10_intended_diff_only": 0.01419999599456787,
      "tpp_threshold_10_unintended_diff_only": 0.0007500022649765015,
      "tpp_threshold_20_total_metric": 0.008850008249282837,
      "tpp_threshold_20_intended_diff_only": 0.00820000171661377,
      "tpp_threshold_20_unintended_diff_only": -0.0006500065326690673,
      "tpp_threshold_50_total_metric": 0.01994999349117279,
      "tpp_threshold_50_intended_diff_only": 0.018799996376037596,
      "tpp_threshold_50_unintended_diff_only": -0.0011499971151351929,
      "tpp_threshold_100_total_metric": 0.025099989771842957,
      "tpp_threshold_100_intended_diff_only": 0.02619999647140503,
      "tpp_threshold_100_unintended_diff_only": 0.0011000066995620727,
      "tpp_threshold_500_total_metric": 0.0778999924659729,
      "tpp_threshold_500_intended_diff_only": 0.08279999494552612,
      "tpp_threshold_500_unintended_diff_only": 0.004900002479553222
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_nce-1024k-gemma-2-2b-resid_post_layer_4-5.0e+08-20251225_1451_resid_post_layer_4/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 18432,
    "hook_layer": 4,
    "hook_name": "blocks.4.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.011750012636184692,
        "tpp_threshold_2_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_2_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_5_total_metric": 0.02000001072883606,
        "tpp_threshold_5_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_5_unintended_diff_only": 0.0010000169277191162,
        "tpp_threshold_10_total_metric": 0.02575002610683441,
        "tpp_threshold_10_intended_diff_only": 0.030000030994415283,
        "tpp_threshold_10_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_20_total_metric": 0.031249985098838806,
        "tpp_threshold_20_intended_diff_only": 0.03299999237060547,
        "tpp_threshold_20_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_50_total_metric": 0.042500048875808716,
        "tpp_threshold_50_intended_diff_only": 0.04700005054473877,
        "tpp_threshold_50_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_100_total_metric": 0.0727500319480896,
        "tpp_threshold_100_intended_diff_only": 0.07600003480911255,
        "tpp_threshold_100_unintended_diff_only": 0.0032500028610229492,
        "tpp_threshold_500_total_metric": 0.16625002026557922,
        "tpp_threshold_500_intended_diff_only": 0.16800004243850708,
        "tpp_threshold_500_unintended_diff_only": 0.0017500221729278564
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0034999847412109375,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.000500023365020752,
        "tpp_threshold_5_total_metric": 0.008249998092651367,
        "tpp_threshold_5_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_5_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_10_total_metric": 0.012249946594238281,
        "tpp_threshold_10_intended_diff_only": 0.011999964714050293,
        "tpp_threshold_10_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_20_total_metric": 0.012249991297721863,
        "tpp_threshold_20_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_20_unintended_diff_only": 0.0007500201463699341,
        "tpp_threshold_50_total_metric": 0.01825001835823059,
        "tpp_threshold_50_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_50_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_100_total_metric": 0.021749943494796753,
        "tpp_threshold_100_intended_diff_only": 0.02599996328353882,
        "tpp_threshold_100_unintended_diff_only": 0.004250019788742065,
        "tpp_threshold_500_total_metric": 0.09699995815753937,
        "tpp_threshold_500_intended_diff_only": 0.09799998998641968,
        "tpp_threshold_500_unintended_diff_only": 0.00100003182888031
      },
      "2": {
        "tpp_threshold_2_total_metric": -0.001749977469444275,
        "tpp_threshold_2_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_5_total_metric": 0.0012500286102294922,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_10_total_metric": 0.010999992489814758,
        "tpp_threshold_10_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_10_unintended_diff_only": 0.0020000189542770386,
        "tpp_threshold_20_total_metric": 0.018000006675720215,
        "tpp_threshold_20_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_20_unintended_diff_only": 0.003000020980834961,
        "tpp_threshold_50_total_metric": 0.031000033020973206,
        "tpp_threshold_50_intended_diff_only": 0.030000030994415283,
        "tpp_threshold_50_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_100_total_metric": 0.04474999010562897,
        "tpp_threshold_100_intended_diff_only": 0.046999990940093994,
        "tpp_threshold_100_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_500_total_metric": 0.10725000500679016,
        "tpp_threshold_500_intended_diff_only": 0.11000001430511475,
        "tpp_threshold_500_unintended_diff_only": 0.002750009298324585
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0002500265836715698,
        "tpp_threshold_2_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_5_total_metric": 0.0037500113248825073,
        "tpp_threshold_5_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_5_unintended_diff_only": -0.001749977469444275,
        "tpp_threshold_10_total_metric": 0.003000035881996155,
        "tpp_threshold_10_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_10_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_20_total_metric": 0.0012500137090682983,
        "tpp_threshold_20_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_20_unintended_diff_only": 0.0007500201463699341,
        "tpp_threshold_50_total_metric": 0.002750009298324585,
        "tpp_threshold_50_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_50_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_100_total_metric": 0.006749987602233887,
        "tpp_threshold_100_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_100_unintended_diff_only": -0.0017499923706054688,
        "tpp_threshold_500_total_metric": 0.00899997353553772,
        "tpp_threshold_500_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_500_unintended_diff_only": 0.0010000169277191162
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0004999786615371704,
        "tpp_threshold_2_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_5_total_metric": -0.001499965786933899,
        "tpp_threshold_5_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_5_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_10_total_metric": 0.006749987602233887,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_20_total_metric": 0.013750016689300537,
        "tpp_threshold_20_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_20_unintended_diff_only": 0.0032500028610229492,
        "tpp_threshold_50_total_metric": 0.025749996304512024,
        "tpp_threshold_50_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_50_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_100_total_metric": 0.037250056862831116,
        "tpp_threshold_100_intended_diff_only": 0.04200005531311035,
        "tpp_threshold_100_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_500_total_metric": 0.11124999821186066,
        "tpp_threshold_500_intended_diff_only": 0.11500000953674316,
        "tpp_threshold_500_unintended_diff_only": 0.0037500113248825073
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.006750032305717468,
        "tpp_threshold_2_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_2_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_5_total_metric": 0.00100003182888031,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_10_total_metric": -0.0004999488592147827,
        "tpp_threshold_10_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_10_unintended_diff_only": 0.002499982714653015,
        "tpp_threshold_20_total_metric": 0.001000046730041504,
        "tpp_threshold_20_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_20_unintended_diff_only": -0.003000020980834961,
        "tpp_threshold_50_total_metric": 0.015500038862228394,
        "tpp_threshold_50_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_50_unintended_diff_only": -0.004500001668930054,
        "tpp_threshold_100_total_metric": 0.013750031590461731,
        "tpp_threshold_100_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_100_unintended_diff_only": -0.0017500072717666626,
        "tpp_threshold_500_total_metric": 0.06750006973743439,
        "tpp_threshold_500_intended_diff_only": 0.0700000524520874,
        "tpp_threshold_500_unintended_diff_only": 0.002499982714653015
      },
      "2": {
        "tpp_threshold_2_total_metric": -4.470348358154297e-08,
        "tpp_threshold_2_intended_diff_only": -0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": -0.001999989151954651,
        "tpp_threshold_5_total_metric": -0.001749977469444275,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_10_total_metric": 0.018499955534934998,
        "tpp_threshold_10_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_10_unintended_diff_only": 0.0015000253915786743,
        "tpp_threshold_20_total_metric": 0.003999993205070496,
        "tpp_threshold_20_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_20_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_50_total_metric": 0.02424997091293335,
        "tpp_threshold_50_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_50_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_100_total_metric": 0.03174997866153717,
        "tpp_threshold_100_intended_diff_only": 0.03299999237060547,
        "tpp_threshold_100_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_500_total_metric": 0.0782499611377716,
        "tpp_threshold_500_intended_diff_only": 0.08099997043609619,
        "tpp_threshold_500_unintended_diff_only": 0.002750009298324585
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.008250027894973755,
        "tpp_threshold_2_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_5_total_metric": -0.0017499923706054688,
        "tpp_threshold_5_intended_diff_only": -0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": -0.004249989986419678,
        "tpp_threshold_10_total_metric": 0.011749997735023499,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": -0.002749994397163391,
        "tpp_threshold_20_total_metric": 0.0005000084638595581,
        "tpp_threshold_20_intended_diff_only": 0.0,
        "tpp_threshold_20_unintended_diff_only": -0.0005000084638595581,
        "tpp_threshold_50_total_metric": 0.004499971866607666,
        "tpp_threshold_50_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_50_unintended_diff_only": -0.0034999847412109375,
        "tpp_threshold_100_total_metric": 0.006749957799911499,
        "tpp_threshold_100_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_100_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_500_total_metric": 0.062249988317489624,
        "tpp_threshold_500_intended_diff_only": 0.06599998474121094,
        "tpp_threshold_500_unintended_diff_only": 0.0037499964237213135
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.016999974846839905,
        "tpp_threshold_2_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_2_unintended_diff_only": -0.001999989151954651,
        "tpp_threshold_5_total_metric": 0.009999945759773254,
        "tpp_threshold_5_intended_diff_only": 0.007999956607818604,
        "tpp_threshold_5_unintended_diff_only": -0.001999989151954651,
        "tpp_threshold_10_total_metric": 0.024749964475631714,
        "tpp_threshold_10_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_10_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_20_total_metric": 0.026749953627586365,
        "tpp_threshold_20_intended_diff_only": 0.026999950408935547,
        "tpp_threshold_20_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_50_total_metric": 0.03199997544288635,
        "tpp_threshold_50_intended_diff_only": 0.0339999794960022,
        "tpp_threshold_50_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_100_total_metric": 0.03949998319149017,
        "tpp_threshold_100_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_100_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_500_total_metric": 0.09774993360042572,
        "tpp_threshold_500_intended_diff_only": 0.10499995946884155,
        "tpp_threshold_500_unintended_diff_only": 0.0072500258684158325
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0025000274181365967,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.0004999935626983643,
        "tpp_threshold_5_total_metric": 0.005500003695487976,
        "tpp_threshold_5_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": -0.006499990820884705,
        "tpp_threshold_10_total_metric": 0.012749999761581421,
        "tpp_threshold_10_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_10_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_20_total_metric": 0.012000039219856262,
        "tpp_threshold_20_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_20_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_50_total_metric": 0.02350001037120819,
        "tpp_threshold_50_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_50_unintended_diff_only": -0.0005000084638595581,
        "tpp_threshold_100_total_metric": 0.03374999761581421,
        "tpp_threshold_100_intended_diff_only": 0.03700000047683716,
        "tpp_threshold_100_unintended_diff_only": 0.0032500028610229492,
        "tpp_threshold_500_total_metric": 0.08375000953674316,
        "tpp_threshold_500_intended_diff_only": 0.09200000762939453,
        "tpp_threshold_500_unintended_diff_only": 0.008249998092651367
      }
    }
  }
}