{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "768ac5e5-2601-42f4-9eed-028be05e4d8b",
  "datetime_epoch_millis": 1767165576592,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.005749997496604919,
      "tpp_threshold_2_intended_diff_only": 0.007200002670288086,
      "tpp_threshold_2_unintended_diff_only": 0.0014500051736831665,
      "tpp_threshold_5_total_metric": 0.01612499803304672,
      "tpp_threshold_5_intended_diff_only": 0.017000001668930054,
      "tpp_threshold_5_unintended_diff_only": 0.0008750036358833313,
      "tpp_threshold_10_total_metric": 0.03179999440908432,
      "tpp_threshold_10_intended_diff_only": 0.034700000286102296,
      "tpp_threshold_10_unintended_diff_only": 0.0029000058770179745,
      "tpp_threshold_20_total_metric": 0.0658249944448471,
      "tpp_threshold_20_intended_diff_only": 0.06949999928474426,
      "tpp_threshold_20_unintended_diff_only": 0.0036750048398971557,
      "tpp_threshold_50_total_metric": 0.17825001031160354,
      "tpp_threshold_50_intended_diff_only": 0.18780001401901247,
      "tpp_threshold_50_unintended_diff_only": 0.009550003707408905,
      "tpp_threshold_100_total_metric": 0.3251000136137009,
      "tpp_threshold_100_intended_diff_only": 0.3410000205039978,
      "tpp_threshold_100_unintended_diff_only": 0.015900006890296935,
      "tpp_threshold_500_total_metric": 0.3512000396847725,
      "tpp_threshold_500_intended_diff_only": 0.4332000494003296,
      "tpp_threshold_500_unintended_diff_only": 0.0820000097155571
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.0006500035524368286,
      "tpp_threshold_2_intended_diff_only": 0.0038000106811523437,
      "tpp_threshold_2_unintended_diff_only": 0.003150007128715515,
      "tpp_threshold_5_total_metric": 0.010749998688697814,
      "tpp_threshold_5_intended_diff_only": 0.01260000467300415,
      "tpp_threshold_5_unintended_diff_only": 0.0018500059843063355,
      "tpp_threshold_10_total_metric": 0.022649997472763063,
      "tpp_threshold_10_intended_diff_only": 0.0252000093460083,
      "tpp_threshold_10_unintended_diff_only": 0.002550011873245239,
      "tpp_threshold_20_total_metric": 0.05579998195171356,
      "tpp_threshold_20_intended_diff_only": 0.0593999981880188,
      "tpp_threshold_20_unintended_diff_only": 0.003600016236305237,
      "tpp_threshold_50_total_metric": 0.16205001175403594,
      "tpp_threshold_50_intended_diff_only": 0.16800001859664918,
      "tpp_threshold_50_unintended_diff_only": 0.00595000684261322,
      "tpp_threshold_100_total_metric": 0.3376500099897385,
      "tpp_threshold_100_intended_diff_only": 0.34660001993179324,
      "tpp_threshold_100_unintended_diff_only": 0.008950009942054749,
      "tpp_threshold_500_total_metric": 0.42265004515647886,
      "tpp_threshold_500_intended_diff_only": 0.4642000555992126,
      "tpp_threshold_500_unintended_diff_only": 0.041550010442733765
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.01084999144077301,
      "tpp_threshold_2_intended_diff_only": 0.010599994659423828,
      "tpp_threshold_2_unintended_diff_only": -0.00024999678134918213,
      "tpp_threshold_5_total_metric": 0.02149999737739563,
      "tpp_threshold_5_intended_diff_only": 0.02139999866485596,
      "tpp_threshold_5_unintended_diff_only": -9.999871253967285e-05,
      "tpp_threshold_10_total_metric": 0.04094999134540558,
      "tpp_threshold_10_intended_diff_only": 0.04419999122619629,
      "tpp_threshold_10_unintended_diff_only": 0.0032499998807907103,
      "tpp_threshold_20_total_metric": 0.07585000693798065,
      "tpp_threshold_20_intended_diff_only": 0.07960000038146972,
      "tpp_threshold_20_unintended_diff_only": 0.0037499934434890745,
      "tpp_threshold_50_total_metric": 0.19445000886917113,
      "tpp_threshold_50_intended_diff_only": 0.20760000944137574,
      "tpp_threshold_50_unintended_diff_only": 0.01315000057220459,
      "tpp_threshold_100_total_metric": 0.3125500172376633,
      "tpp_threshold_100_intended_diff_only": 0.33540002107620237,
      "tpp_threshold_100_unintended_diff_only": 0.022850003838539124,
      "tpp_threshold_500_total_metric": 0.2797500342130661,
      "tpp_threshold_500_intended_diff_only": 0.40220004320144653,
      "tpp_threshold_500_unintended_diff_only": 0.12245000898838043
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_hsic-1024k-BatchTopK-gemma-2-2b-resid_post_layer_4-5.0e+08-20251226_2325_resid_post_layer_4/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 18432,
    "hook_layer": 4,
    "hook_name": "blocks.4.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "batch_topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0029999911785125732,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_5_total_metric": 0.020999997854232788,
        "tpp_threshold_5_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_5_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_10_total_metric": 0.03325003385543823,
        "tpp_threshold_10_intended_diff_only": 0.03800004720687866,
        "tpp_threshold_10_unintended_diff_only": 0.00475001335144043,
        "tpp_threshold_20_total_metric": 0.0742499828338623,
        "tpp_threshold_20_intended_diff_only": 0.078000009059906,
        "tpp_threshold_20_unintended_diff_only": 0.003750026226043701,
        "tpp_threshold_50_total_metric": 0.2080000340938568,
        "tpp_threshold_50_intended_diff_only": 0.21400004625320435,
        "tpp_threshold_50_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_100_total_metric": 0.3982500284910202,
        "tpp_threshold_100_intended_diff_only": 0.4050000309944153,
        "tpp_threshold_100_unintended_diff_only": 0.006750002503395081,
        "tpp_threshold_500_total_metric": 0.41050006449222565,
        "tpp_threshold_500_intended_diff_only": 0.4440000653266907,
        "tpp_threshold_500_unintended_diff_only": 0.03350000083446503
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.00899997353553772,
        "tpp_threshold_2_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_2_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_5_total_metric": 0.013999983668327332,
        "tpp_threshold_5_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_5_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_10_total_metric": 0.03099997341632843,
        "tpp_threshold_10_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_10_unintended_diff_only": 0.00100003182888031,
        "tpp_threshold_20_total_metric": 0.05574995279312134,
        "tpp_threshold_20_intended_diff_only": 0.05699998140335083,
        "tpp_threshold_20_unintended_diff_only": 0.0012500286102294922,
        "tpp_threshold_50_total_metric": 0.18825002014636993,
        "tpp_threshold_50_intended_diff_only": 0.19700002670288086,
        "tpp_threshold_50_unintended_diff_only": 0.008750006556510925,
        "tpp_threshold_100_total_metric": 0.3934999704360962,
        "tpp_threshold_100_intended_diff_only": 0.40299999713897705,
        "tpp_threshold_100_unintended_diff_only": 0.00950002670288086,
        "tpp_threshold_500_total_metric": 0.41450001299381256,
        "tpp_threshold_500_intended_diff_only": 0.4650000333786011,
        "tpp_threshold_500_unintended_diff_only": 0.05050002038478851
      },
      "2": {
        "tpp_threshold_2_total_metric": -0.006750002503395081,
        "tpp_threshold_2_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_5_total_metric": 0.01524999737739563,
        "tpp_threshold_5_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_5_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_10_total_metric": 0.02850000560283661,
        "tpp_threshold_10_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_10_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_20_total_metric": 0.07499997317790985,
        "tpp_threshold_20_intended_diff_only": 0.07999998331069946,
        "tpp_threshold_20_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_50_total_metric": 0.22175000607967377,
        "tpp_threshold_50_intended_diff_only": 0.22699999809265137,
        "tpp_threshold_50_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_100_total_metric": 0.35750001668930054,
        "tpp_threshold_100_intended_diff_only": 0.37300002574920654,
        "tpp_threshold_100_unintended_diff_only": 0.015500009059906006,
        "tpp_threshold_500_total_metric": 0.3957500457763672,
        "tpp_threshold_500_intended_diff_only": 0.4450000524520874,
        "tpp_threshold_500_unintended_diff_only": 0.049250006675720215
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0009999871253967285,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_total_metric": 0.0037500113248825073,
        "tpp_threshold_5_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_10_total_metric": 0.009249985218048096,
        "tpp_threshold_10_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_10_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_20_total_metric": 0.011249974370002747,
        "tpp_threshold_20_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_20_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_50_total_metric": 0.03674997389316559,
        "tpp_threshold_50_intended_diff_only": 0.04100000858306885,
        "tpp_threshold_50_unintended_diff_only": 0.004250034689903259,
        "tpp_threshold_100_total_metric": 0.23424997925758362,
        "tpp_threshold_100_intended_diff_only": 0.23600000143051147,
        "tpp_threshold_100_unintended_diff_only": 0.0017500221729278564,
        "tpp_threshold_500_total_metric": 0.4725000560283661,
        "tpp_threshold_500_intended_diff_only": 0.49100005626678467,
        "tpp_threshold_500_unintended_diff_only": 0.01850000023841858
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0009999573230743408,
        "tpp_threshold_2_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_2_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_5_total_metric": -0.00024999678134918213,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": 0.003250017762184143,
        "tpp_threshold_10_total_metric": 0.01124998927116394,
        "tpp_threshold_10_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_10_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_20_total_metric": 0.06275002658367157,
        "tpp_threshold_20_intended_diff_only": 0.06700003147125244,
        "tpp_threshold_20_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_50_total_metric": 0.15550002455711365,
        "tpp_threshold_50_intended_diff_only": 0.16100001335144043,
        "tpp_threshold_50_unintended_diff_only": 0.005499988794326782,
        "tpp_threshold_100_total_metric": 0.3047500550746918,
        "tpp_threshold_100_intended_diff_only": 0.3160000443458557,
        "tpp_threshold_100_unintended_diff_only": 0.01124998927116394,
        "tpp_threshold_500_total_metric": 0.4200000464916229,
        "tpp_threshold_500_intended_diff_only": 0.4760000705718994,
        "tpp_threshold_500_unintended_diff_only": 0.05600002408027649
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.013500019907951355,
        "tpp_threshold_2_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_2_unintended_diff_only": -0.0005000084638595581,
        "tpp_threshold_5_total_metric": 0.022500038146972656,
        "tpp_threshold_5_intended_diff_only": 0.025000035762786865,
        "tpp_threshold_5_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_10_total_metric": 0.027500003576278687,
        "tpp_threshold_10_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_10_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_20_total_metric": 0.06425005197525024,
        "tpp_threshold_20_intended_diff_only": 0.06600004434585571,
        "tpp_threshold_20_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_50_total_metric": 0.17825007438659668,
        "tpp_threshold_50_intended_diff_only": 0.19000005722045898,
        "tpp_threshold_50_unintended_diff_only": 0.011749982833862305,
        "tpp_threshold_100_total_metric": 0.317250058054924,
        "tpp_threshold_100_intended_diff_only": 0.34300005435943604,
        "tpp_threshold_100_unintended_diff_only": 0.025749996304512024,
        "tpp_threshold_500_total_metric": 0.3355000764131546,
        "tpp_threshold_500_intended_diff_only": 0.43900007009506226,
        "tpp_threshold_500_unintended_diff_only": 0.10349999368190765
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.0007499903440475464,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_5_total_metric": 0.006999999284744263,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_10_total_metric": 0.026749998331069946,
        "tpp_threshold_10_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_10_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_20_total_metric": 0.040249988436698914,
        "tpp_threshold_20_intended_diff_only": 0.042999982833862305,
        "tpp_threshold_20_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_50_total_metric": 0.10049997270107269,
        "tpp_threshold_50_intended_diff_only": 0.11299997568130493,
        "tpp_threshold_50_unintended_diff_only": 0.012500002980232239,
        "tpp_threshold_100_total_metric": 0.25174999237060547,
        "tpp_threshold_100_intended_diff_only": 0.28200000524520874,
        "tpp_threshold_100_unintended_diff_only": 0.03025001287460327,
        "tpp_threshold_500_total_metric": 0.23750002682209015,
        "tpp_threshold_500_intended_diff_only": 0.4230000376701355,
        "tpp_threshold_500_unintended_diff_only": 0.18550001084804535
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.009000003337860107,
        "tpp_threshold_2_intended_diff_only": -0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": 0.0,
        "tpp_threshold_5_total_metric": -0.0020000338554382324,
        "tpp_threshold_5_intended_diff_only": -0.00700002908706665,
        "tpp_threshold_5_unintended_diff_only": -0.004999995231628418,
        "tpp_threshold_10_total_metric": 0.015499979257583618,
        "tpp_threshold_10_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_10_unintended_diff_only": -0.004500001668930054,
        "tpp_threshold_20_total_metric": 0.028500020503997803,
        "tpp_threshold_20_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_20_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_50_total_metric": 0.20099999010562897,
        "tpp_threshold_50_intended_diff_only": 0.21299999952316284,
        "tpp_threshold_50_unintended_diff_only": 0.012000009417533875,
        "tpp_threshold_100_total_metric": 0.3332500159740448,
        "tpp_threshold_100_intended_diff_only": 0.3460000157356262,
        "tpp_threshold_100_unintended_diff_only": 0.012749999761581421,
        "tpp_threshold_500_total_metric": 0.3112500309944153,
        "tpp_threshold_500_intended_diff_only": 0.39500004053115845,
        "tpp_threshold_500_unintended_diff_only": 0.08375000953674316
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.04349997639656067,
        "tpp_threshold_2_intended_diff_only": 0.042999982833862305,
        "tpp_threshold_2_unintended_diff_only": -0.0004999935626983643,
        "tpp_threshold_5_total_metric": 0.049999967217445374,
        "tpp_threshold_5_intended_diff_only": 0.04899996519088745,
        "tpp_threshold_5_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_10_total_metric": 0.06699997186660767,
        "tpp_threshold_10_intended_diff_only": 0.07099997997283936,
        "tpp_threshold_10_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_total_metric": 0.11699996888637543,
        "tpp_threshold_20_intended_diff_only": 0.12199997901916504,
        "tpp_threshold_20_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_50_total_metric": 0.2294999659061432,
        "tpp_threshold_50_intended_diff_only": 0.24799996614456177,
        "tpp_threshold_50_unintended_diff_only": 0.01850000023841858,
        "tpp_threshold_100_total_metric": 0.33149997889995575,
        "tpp_threshold_100_intended_diff_only": 0.3619999885559082,
        "tpp_threshold_100_unintended_diff_only": 0.030500009655952454,
        "tpp_threshold_500_total_metric": 0.2409999966621399,
        "tpp_threshold_500_intended_diff_only": 0.406000018119812,
        "tpp_threshold_500_unintended_diff_only": 0.16500002145767212
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.005499973893165588,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_5_total_metric": 0.03000001609325409,
        "tpp_threshold_5_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_5_unintended_diff_only": -0.003000006079673767,
        "tpp_threshold_10_total_metric": 0.06800000369548798,
        "tpp_threshold_10_intended_diff_only": 0.07499998807907104,
        "tpp_threshold_10_unintended_diff_only": 0.006999984383583069,
        "tpp_threshold_20_total_metric": 0.12925000488758087,
        "tpp_threshold_20_intended_diff_only": 0.13499999046325684,
        "tpp_threshold_20_unintended_diff_only": 0.005749985575675964,
        "tpp_threshold_50_total_metric": 0.2630000412464142,
        "tpp_threshold_50_intended_diff_only": 0.27400004863739014,
        "tpp_threshold_50_unintended_diff_only": 0.011000007390975952,
        "tpp_threshold_100_total_metric": 0.3290000408887863,
        "tpp_threshold_100_intended_diff_only": 0.34400004148483276,
        "tpp_threshold_100_unintended_diff_only": 0.015000000596046448,
        "tpp_threshold_500_total_metric": 0.2735000401735306,
        "tpp_threshold_500_intended_diff_only": 0.34800004959106445,
        "tpp_threshold_500_unintended_diff_only": 0.07450000941753387
      }
    }
  }
}