{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-9b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "679ebb8a-75ba-444b-be22-fa9bbc047784",
  "datetime_epoch_millis": 1765445022449,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.006124992668628693,
      "tpp_threshold_2_intended_diff_only": 0.007399994134902954,
      "tpp_threshold_2_unintended_diff_only": 0.0012750014662742614,
      "tpp_threshold_5_total_metric": 0.01664999723434448,
      "tpp_threshold_5_intended_diff_only": 0.01759999990463257,
      "tpp_threshold_5_unintended_diff_only": 0.0009500026702880859,
      "tpp_threshold_10_total_metric": 0.026274994015693665,
      "tpp_threshold_10_intended_diff_only": 0.029100000858306885,
      "tpp_threshold_10_unintended_diff_only": 0.00282500684261322,
      "tpp_threshold_20_total_metric": 0.043599995970726016,
      "tpp_threshold_20_intended_diff_only": 0.04649999737739563,
      "tpp_threshold_20_unintended_diff_only": 0.002900001406669617,
      "tpp_threshold_50_total_metric": 0.09867500364780427,
      "tpp_threshold_50_intended_diff_only": 0.10260000824928284,
      "tpp_threshold_50_unintended_diff_only": 0.003925004601478577,
      "tpp_threshold_100_total_metric": 0.1938750073313713,
      "tpp_threshold_100_intended_diff_only": 0.1998000144958496,
      "tpp_threshold_100_unintended_diff_only": 0.005925007164478302,
      "tpp_threshold_500_total_metric": 0.4266250282526016,
      "tpp_threshold_500_intended_diff_only": 0.4405000329017639,
      "tpp_threshold_500_unintended_diff_only": 0.013875004649162293
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.005199986696243286,
      "tpp_threshold_2_intended_diff_only": 0.009199988842010499,
      "tpp_threshold_2_unintended_diff_only": 0.004000002145767212,
      "tpp_threshold_5_total_metric": 0.011449995636940002,
      "tpp_threshold_5_intended_diff_only": 0.014800000190734863,
      "tpp_threshold_5_unintended_diff_only": 0.003350004553794861,
      "tpp_threshold_10_total_metric": 0.016549989581108093,
      "tpp_threshold_10_intended_diff_only": 0.02139999866485596,
      "tpp_threshold_10_unintended_diff_only": 0.004850009083747863,
      "tpp_threshold_20_total_metric": 0.03144998848438263,
      "tpp_threshold_20_intended_diff_only": 0.03599998950958252,
      "tpp_threshold_20_unintended_diff_only": 0.0045500010251998905,
      "tpp_threshold_50_total_metric": 0.07369999587535858,
      "tpp_threshold_50_intended_diff_only": 0.08059999942779542,
      "tpp_threshold_50_unintended_diff_only": 0.006900003552436829,
      "tpp_threshold_100_total_metric": 0.1673000007867813,
      "tpp_threshold_100_intended_diff_only": 0.17400000095367432,
      "tpp_threshold_100_unintended_diff_only": 0.006700000166893006,
      "tpp_threshold_500_total_metric": 0.45480001866817477,
      "tpp_threshold_500_intended_diff_only": 0.4660000205039978,
      "tpp_threshold_500_unintended_diff_only": 0.01120000183582306
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0070499986410140995,
      "tpp_threshold_2_intended_diff_only": 0.00559999942779541,
      "tpp_threshold_2_unintended_diff_only": -0.001449999213218689,
      "tpp_threshold_5_total_metric": 0.021849998831748964,
      "tpp_threshold_5_intended_diff_only": 0.020399999618530274,
      "tpp_threshold_5_unintended_diff_only": -0.001449999213218689,
      "tpp_threshold_10_total_metric": 0.035999998450279236,
      "tpp_threshold_10_intended_diff_only": 0.03680000305175781,
      "tpp_threshold_10_unintended_diff_only": 0.0008000046014785767,
      "tpp_threshold_20_total_metric": 0.055750003457069396,
      "tpp_threshold_20_intended_diff_only": 0.05700000524520874,
      "tpp_threshold_20_unintended_diff_only": 0.0012500017881393432,
      "tpp_threshold_50_total_metric": 0.12365001142024994,
      "tpp_threshold_50_intended_diff_only": 0.12460001707077026,
      "tpp_threshold_50_unintended_diff_only": 0.0009500056505203248,
      "tpp_threshold_100_total_metric": 0.2204500138759613,
      "tpp_threshold_100_intended_diff_only": 0.2256000280380249,
      "tpp_threshold_100_unintended_diff_only": 0.005150014162063598,
      "tpp_threshold_500_total_metric": 0.3984500378370285,
      "tpp_threshold_500_intended_diff_only": 0.41500004529953005,
      "tpp_threshold_500_unintended_diff_only": 0.016550007462501525
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_hsic-1024k-sample-gemma-2-9b-resid_post_layer_25-5.0e+08-20251204_1152_resid_post_layer_25/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-9b",
    "d_in": 3584,
    "d_sae": 28672,
    "hook_layer": 25,
    "hook_name": "blocks.25.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.011000007390975952,
        "tpp_threshold_2_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_2_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_5_total_metric": 0.014750033617019653,
        "tpp_threshold_5_intended_diff_only": 0.016000032424926758,
        "tpp_threshold_5_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_10_total_metric": 0.018250003457069397,
        "tpp_threshold_10_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_10_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_20_total_metric": 0.022249996662139893,
        "tpp_threshold_20_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_20_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_50_total_metric": 0.05174998939037323,
        "tpp_threshold_50_intended_diff_only": 0.0559999942779541,
        "tpp_threshold_50_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_100_total_metric": 0.13124999403953552,
        "tpp_threshold_100_intended_diff_only": 0.13499999046325684,
        "tpp_threshold_100_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_500_total_metric": 0.4442500174045563,
        "tpp_threshold_500_intended_diff_only": 0.4520000219345093,
        "tpp_threshold_500_unintended_diff_only": 0.007750004529953003
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0027499645948410034,
        "tpp_threshold_2_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_5_total_metric": 0.0024999678134918213,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_10_total_metric": 0.00849999487400055,
        "tpp_threshold_10_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_10_unintended_diff_only": 0.0045000165700912476,
        "tpp_threshold_20_total_metric": 0.018749982118606567,
        "tpp_threshold_20_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_20_unintended_diff_only": 0.0062499940395355225,
        "tpp_threshold_50_total_metric": 0.04150000214576721,
        "tpp_threshold_50_intended_diff_only": 0.050999999046325684,
        "tpp_threshold_50_unintended_diff_only": 0.009499996900558472,
        "tpp_threshold_100_total_metric": 0.09874999523162842,
        "tpp_threshold_100_intended_diff_only": 0.10699999332427979,
        "tpp_threshold_100_unintended_diff_only": 0.008249998092651367,
        "tpp_threshold_500_total_metric": 0.43824997544288635,
        "tpp_threshold_500_intended_diff_only": 0.44999998807907104,
        "tpp_threshold_500_unintended_diff_only": 0.011750012636184692
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.005499988794326782,
        "tpp_threshold_2_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_2_unintended_diff_only": 0.009499996900558472,
        "tpp_threshold_5_total_metric": 0.02124999463558197,
        "tpp_threshold_5_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_5_unintended_diff_only": 0.006750002503395081,
        "tpp_threshold_10_total_metric": 0.02775000035762787,
        "tpp_threshold_10_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_10_unintended_diff_only": 0.008250012993812561,
        "tpp_threshold_20_total_metric": 0.058750033378601074,
        "tpp_threshold_20_intended_diff_only": 0.06700003147125244,
        "tpp_threshold_20_unintended_diff_only": 0.008249998092651367,
        "tpp_threshold_50_total_metric": 0.13900001347064972,
        "tpp_threshold_50_intended_diff_only": 0.1510000228881836,
        "tpp_threshold_50_unintended_diff_only": 0.012000009417533875,
        "tpp_threshold_100_total_metric": 0.2670000046491623,
        "tpp_threshold_100_intended_diff_only": 0.2770000100135803,
        "tpp_threshold_100_unintended_diff_only": 0.01000000536441803,
        "tpp_threshold_500_total_metric": 0.4412500560283661,
        "tpp_threshold_500_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_500_unintended_diff_only": 0.012749999761581421
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0012500137090682983,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_5_total_metric": 0.0027499496936798096,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_10_total_metric": 0.007249936461448669,
        "tpp_threshold_10_intended_diff_only": 0.008999943733215332,
        "tpp_threshold_10_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_20_total_metric": 0.008249923586845398,
        "tpp_threshold_20_intended_diff_only": 0.008999943733215332,
        "tpp_threshold_20_unintended_diff_only": 0.0007500201463699341,
        "tpp_threshold_50_total_metric": 0.014999955892562866,
        "tpp_threshold_50_intended_diff_only": 0.01699995994567871,
        "tpp_threshold_50_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_100_total_metric": 0.11749997735023499,
        "tpp_threshold_100_intended_diff_only": 0.12199997901916504,
        "tpp_threshold_100_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_500_total_metric": 0.48274996876716614,
        "tpp_threshold_500_intended_diff_only": 0.49299997091293335,
        "tpp_threshold_500_unintended_diff_only": 0.010250002145767212
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.007999986410140991,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_5_total_metric": 0.016000032424926758,
        "tpp_threshold_5_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_5_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_10_total_metric": 0.021000012755393982,
        "tpp_threshold_10_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_10_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_20_total_metric": 0.049250006675720215,
        "tpp_threshold_20_intended_diff_only": 0.05500000715255737,
        "tpp_threshold_20_unintended_diff_only": 0.005750000476837158,
        "tpp_threshold_50_total_metric": 0.12125001847743988,
        "tpp_threshold_50_intended_diff_only": 0.12800002098083496,
        "tpp_threshold_50_unintended_diff_only": 0.006750002503395081,
        "tpp_threshold_100_total_metric": 0.22200003266334534,
        "tpp_threshold_100_intended_diff_only": 0.2290000319480896,
        "tpp_threshold_100_unintended_diff_only": 0.006999999284744263,
        "tpp_threshold_500_total_metric": 0.46750007569789886,
        "tpp_threshold_500_intended_diff_only": 0.48100006580352783,
        "tpp_threshold_500_unintended_diff_only": 0.013499990105628967
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": -0.0010000169277191162,
        "tpp_threshold_2_intended_diff_only": -0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": -0.0020000040531158447,
        "tpp_threshold_5_total_metric": 0.002499982714653015,
        "tpp_threshold_5_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": -0.0014999955892562866,
        "tpp_threshold_10_total_metric": 0.002499982714653015,
        "tpp_threshold_10_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_10_unintended_diff_only": -0.0014999955892562866,
        "tpp_threshold_20_total_metric": 0.006000012159347534,
        "tpp_threshold_20_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_20_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_50_total_metric": 0.036750003695487976,
        "tpp_threshold_50_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_50_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_100_total_metric": 0.08100001513957977,
        "tpp_threshold_100_intended_diff_only": 0.08600002527236938,
        "tpp_threshold_100_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_500_total_metric": 0.39900001883506775,
        "tpp_threshold_500_intended_diff_only": 0.4140000343322754,
        "tpp_threshold_500_unintended_diff_only": 0.015000015497207642
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.014750003814697266,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": -0.0027499794960021973,
        "tpp_threshold_5_total_metric": 0.011000022292137146,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_10_total_metric": 0.03425000607967377,
        "tpp_threshold_10_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_10_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_20_total_metric": 0.05100001394748688,
        "tpp_threshold_20_intended_diff_only": 0.050999999046325684,
        "tpp_threshold_20_unintended_diff_only": -1.4901161193847656e-08,
        "tpp_threshold_50_total_metric": 0.09975002706050873,
        "tpp_threshold_50_intended_diff_only": 0.10000002384185791,
        "tpp_threshold_50_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_100_total_metric": 0.23925000429153442,
        "tpp_threshold_100_intended_diff_only": 0.23900002241134644,
        "tpp_threshold_100_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_500_total_metric": 0.4150000512599945,
        "tpp_threshold_500_intended_diff_only": 0.4360000491142273,
        "tpp_threshold_500_unintended_diff_only": 0.020999997854232788
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.0010000169277191162,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_5_total_metric": 0.006749972701072693,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": -0.0007499903440475464,
        "tpp_threshold_10_total_metric": 0.018999993801116943,
        "tpp_threshold_10_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_10_unintended_diff_only": 0.0,
        "tpp_threshold_20_total_metric": 0.020750001072883606,
        "tpp_threshold_20_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_20_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_50_total_metric": 0.060999974608421326,
        "tpp_threshold_50_intended_diff_only": 0.05699998140335083,
        "tpp_threshold_50_unintended_diff_only": -0.003999993205070496,
        "tpp_threshold_100_total_metric": 0.1495000272989273,
        "tpp_threshold_100_intended_diff_only": 0.15500003099441528,
        "tpp_threshold_100_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_500_total_metric": 0.41075003147125244,
        "tpp_threshold_500_intended_diff_only": 0.4230000376701355,
        "tpp_threshold_500_unintended_diff_only": 0.012250006198883057
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.02275000512599945,
        "tpp_threshold_2_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_2_unintended_diff_only": -0.0037500113248825073,
        "tpp_threshold_5_total_metric": 0.06574998795986176,
        "tpp_threshold_5_intended_diff_only": 0.06099998950958252,
        "tpp_threshold_5_unintended_diff_only": -0.004749998450279236,
        "tpp_threshold_10_total_metric": 0.06050001084804535,
        "tpp_threshold_10_intended_diff_only": 0.06800001859664917,
        "tpp_threshold_10_unintended_diff_only": 0.007500007748603821,
        "tpp_threshold_20_total_metric": 0.09300000965595245,
        "tpp_threshold_20_intended_diff_only": 0.09700000286102295,
        "tpp_threshold_20_unintended_diff_only": 0.003999993205070496,
        "tpp_threshold_50_total_metric": 0.19100002944469452,
        "tpp_threshold_50_intended_diff_only": 0.19600003957748413,
        "tpp_threshold_50_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_100_total_metric": 0.3237500339746475,
        "tpp_threshold_100_intended_diff_only": 0.3290000557899475,
        "tpp_threshold_100_unintended_diff_only": 0.005250021815299988,
        "tpp_threshold_500_total_metric": 0.40900005400180817,
        "tpp_threshold_500_intended_diff_only": 0.42600005865097046,
        "tpp_threshold_500_unintended_diff_only": 0.017000004649162292
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0002499818801879883,
        "tpp_threshold_2_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_5_total_metric": 0.023250028491020203,
        "tpp_threshold_5_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_5_unintended_diff_only": -0.002250000834465027,
        "tpp_threshold_10_total_metric": 0.0637499988079071,
        "tpp_threshold_10_intended_diff_only": 0.06000000238418579,
        "tpp_threshold_10_unintended_diff_only": -0.0037499964237213135,
        "tpp_threshold_20_total_metric": 0.10799998044967651,
        "tpp_threshold_20_intended_diff_only": 0.10699999332427979,
        "tpp_threshold_20_unintended_diff_only": -0.0009999871253967285,
        "tpp_threshold_50_total_metric": 0.22975002229213715,
        "tpp_threshold_50_intended_diff_only": 0.23400002717971802,
        "tpp_threshold_50_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_100_total_metric": 0.3087499886751175,
        "tpp_threshold_100_intended_diff_only": 0.3190000057220459,
        "tpp_threshold_100_unintended_diff_only": 0.010250017046928406,
        "tpp_threshold_500_total_metric": 0.35850003361701965,
        "tpp_threshold_500_intended_diff_only": 0.3760000467300415,
        "tpp_threshold_500_unintended_diff_only": 0.01750001311302185
      }
    }
  }
}