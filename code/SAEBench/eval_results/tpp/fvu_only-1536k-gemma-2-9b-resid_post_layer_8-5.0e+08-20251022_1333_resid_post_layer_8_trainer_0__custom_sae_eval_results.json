{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-9b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "0429e4e7-f6c4-45c7-a30c-2fb02f3e7290",
  "datetime_epoch_millis": 1761462173432,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.003350000083446503,
      "tpp_threshold_2_intended_diff_only": 0.003800004720687866,
      "tpp_threshold_2_unintended_diff_only": 0.00045000463724136357,
      "tpp_threshold_5_total_metric": 0.006450007855892182,
      "tpp_threshold_5_intended_diff_only": 0.00930001139640808,
      "tpp_threshold_5_unintended_diff_only": 0.0028500035405158997,
      "tpp_threshold_10_total_metric": 0.04560000747442246,
      "tpp_threshold_10_intended_diff_only": 0.05460001230239868,
      "tpp_threshold_10_unintended_diff_only": 0.009000004827976226,
      "tpp_threshold_20_total_metric": 0.2341250091791153,
      "tpp_threshold_20_intended_diff_only": 0.2599000155925751,
      "tpp_threshold_20_unintended_diff_only": 0.025775006413459776,
      "tpp_threshold_50_total_metric": 0.3654500335454941,
      "tpp_threshold_50_intended_diff_only": 0.4464000463485718,
      "tpp_threshold_50_unintended_diff_only": 0.0809500128030777,
      "tpp_threshold_100_total_metric": 0.28167503923177717,
      "tpp_threshold_100_intended_diff_only": 0.44800004959106443,
      "tpp_threshold_100_unintended_diff_only": 0.16632501035928726,
      "tpp_threshold_500_total_metric": 0.1102750226855278,
      "tpp_threshold_500_intended_diff_only": 0.44800004959106443,
      "tpp_threshold_500_unintended_diff_only": 0.33772502690553663
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.0009000033140182495,
      "tpp_threshold_2_intended_diff_only": 0.0038000106811523437,
      "tpp_threshold_2_unintended_diff_only": 0.0029000073671340944,
      "tpp_threshold_5_total_metric": 0.010500013828277588,
      "tpp_threshold_5_intended_diff_only": 0.013400018215179443,
      "tpp_threshold_5_unintended_diff_only": 0.0029000043869018555,
      "tpp_threshold_10_total_metric": 0.04585000276565552,
      "tpp_threshold_10_intended_diff_only": 0.05240001678466797,
      "tpp_threshold_10_unintended_diff_only": 0.006550014019012451,
      "tpp_threshold_20_total_metric": 0.32825001776218415,
      "tpp_threshold_20_intended_diff_only": 0.3488000273704529,
      "tpp_threshold_20_unintended_diff_only": 0.02055000960826874,
      "tpp_threshold_50_total_metric": 0.38985003530979156,
      "tpp_threshold_50_intended_diff_only": 0.46980005502700806,
      "tpp_threshold_50_unintended_diff_only": 0.07995001971721649,
      "tpp_threshold_100_total_metric": 0.32090004086494445,
      "tpp_threshold_100_intended_diff_only": 0.46980005502700806,
      "tpp_threshold_100_unintended_diff_only": 0.1489000141620636,
      "tpp_threshold_500_total_metric": 0.14400002658367156,
      "tpp_threshold_500_intended_diff_only": 0.46980005502700806,
      "tpp_threshold_500_unintended_diff_only": 0.3258000284433365
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.005799996852874756,
      "tpp_threshold_2_intended_diff_only": 0.0037999987602233888,
      "tpp_threshold_2_unintended_diff_only": -0.0019999980926513673,
      "tpp_threshold_5_total_metric": 0.002400001883506775,
      "tpp_threshold_5_intended_diff_only": 0.005200004577636719,
      "tpp_threshold_5_unintended_diff_only": 0.002800002694129944,
      "tpp_threshold_10_total_metric": 0.04535001218318939,
      "tpp_threshold_10_intended_diff_only": 0.056800007820129395,
      "tpp_threshold_10_unintended_diff_only": 0.011449995636940002,
      "tpp_threshold_20_total_metric": 0.14000000059604645,
      "tpp_threshold_20_intended_diff_only": 0.17100000381469727,
      "tpp_threshold_20_unintended_diff_only": 0.031000003218650818,
      "tpp_threshold_50_total_metric": 0.3410500317811966,
      "tpp_threshold_50_intended_diff_only": 0.4230000376701355,
      "tpp_threshold_50_unintended_diff_only": 0.0819500058889389,
      "tpp_threshold_100_total_metric": 0.24245003759860992,
      "tpp_threshold_100_intended_diff_only": 0.42620004415512086,
      "tpp_threshold_100_unintended_diff_only": 0.18375000655651091,
      "tpp_threshold_500_total_metric": 0.07655001878738403,
      "tpp_threshold_500_intended_diff_only": 0.42620004415512086,
      "tpp_threshold_500_unintended_diff_only": 0.3496500253677368
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "fvu_only-1536k-gemma-2-9b-resid_post_layer_8-5.0e+08-20251022_1333_resid_post_layer_8/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-9b",
    "d_in": 3584,
    "d_sae": 28672,
    "hook_layer": 8,
    "hook_name": "blocks.8.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "float32",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.0034999698400497437,
        "tpp_threshold_2_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_5_total_metric": 0.01850004494190216,
        "tpp_threshold_5_intended_diff_only": 0.020000040531158447,
        "tpp_threshold_5_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_10_total_metric": 0.07149998843669891,
        "tpp_threshold_10_intended_diff_only": 0.07899999618530273,
        "tpp_threshold_10_unintended_diff_only": 0.007500007748603821,
        "tpp_threshold_20_total_metric": 0.2265000194311142,
        "tpp_threshold_20_intended_diff_only": 0.2380000352859497,
        "tpp_threshold_20_unintended_diff_only": 0.01150001585483551,
        "tpp_threshold_50_total_metric": 0.40275004506111145,
        "tpp_threshold_50_intended_diff_only": 0.4580000638961792,
        "tpp_threshold_50_unintended_diff_only": 0.05525001883506775,
        "tpp_threshold_100_total_metric": 0.3590000718832016,
        "tpp_threshold_100_intended_diff_only": 0.4580000638961792,
        "tpp_threshold_100_unintended_diff_only": 0.0989999920129776,
        "tpp_threshold_500_total_metric": 0.20625005662441254,
        "tpp_threshold_500_intended_diff_only": 0.4580000638961792,
        "tpp_threshold_500_unintended_diff_only": 0.25175000727176666
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.004250034689903259,
        "tpp_threshold_2_intended_diff_only": 0.006000041961669922,
        "tpp_threshold_2_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_5_total_metric": -0.002749994397163391,
        "tpp_threshold_5_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_10_total_metric": 0.04525002837181091,
        "tpp_threshold_10_intended_diff_only": 0.05200004577636719,
        "tpp_threshold_10_unintended_diff_only": 0.006750017404556274,
        "tpp_threshold_20_total_metric": 0.33900003135204315,
        "tpp_threshold_20_intended_diff_only": 0.38200002908706665,
        "tpp_threshold_20_unintended_diff_only": 0.0429999977350235,
        "tpp_threshold_50_total_metric": 0.2797500491142273,
        "tpp_threshold_50_intended_diff_only": 0.4580000638961792,
        "tpp_threshold_50_unintended_diff_only": 0.1782500147819519,
        "tpp_threshold_100_total_metric": 0.1900000423192978,
        "tpp_threshold_100_intended_diff_only": 0.4580000638961792,
        "tpp_threshold_100_unintended_diff_only": 0.2680000215768814,
        "tpp_threshold_500_total_metric": -0.006499961018562317,
        "tpp_threshold_500_intended_diff_only": 0.4580000638961792,
        "tpp_threshold_500_unintended_diff_only": 0.4645000249147415
      },
      "2": {
        "tpp_threshold_2_total_metric": -0.0047500282526016235,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_5_total_metric": 0.002750024199485779,
        "tpp_threshold_5_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_5_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_10_total_metric": 0.003000020980834961,
        "tpp_threshold_10_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_10_unintended_diff_only": 0.008000016212463379,
        "tpp_threshold_20_total_metric": 0.3175000101327896,
        "tpp_threshold_20_intended_diff_only": 0.3320000171661377,
        "tpp_threshold_20_unintended_diff_only": 0.014500007033348083,
        "tpp_threshold_50_total_metric": 0.35725003480911255,
        "tpp_threshold_50_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_50_unintended_diff_only": 0.09675002098083496,
        "tpp_threshold_100_total_metric": 0.29875002801418304,
        "tpp_threshold_100_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_100_unintended_diff_only": 0.15525002777576447,
        "tpp_threshold_500_total_metric": 0.09050001204013824,
        "tpp_threshold_500_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_500_unintended_diff_only": 0.36350004374980927
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.001999959349632263,
        "tpp_threshold_2_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_2_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_5_total_metric": 0.0027499794960021973,
        "tpp_threshold_5_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_10_total_metric": 0.009499967098236084,
        "tpp_threshold_10_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_10_unintended_diff_only": 0.000500023365020752,
        "tpp_threshold_20_total_metric": 0.318000003695488,
        "tpp_threshold_20_intended_diff_only": 0.3230000138282776,
        "tpp_threshold_20_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_50_total_metric": 0.47075000405311584,
        "tpp_threshold_50_intended_diff_only": 0.48900002241134644,
        "tpp_threshold_50_unintended_diff_only": 0.01825001835823059,
        "tpp_threshold_100_total_metric": 0.41325001418590546,
        "tpp_threshold_100_intended_diff_only": 0.48900002241134644,
        "tpp_threshold_100_unintended_diff_only": 0.07575000822544098,
        "tpp_threshold_500_total_metric": 0.2672499865293503,
        "tpp_threshold_500_intended_diff_only": 0.48900002241134644,
        "tpp_threshold_500_unintended_diff_only": 0.22175003588199615
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.006500020623207092,
        "tpp_threshold_2_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_2_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_5_total_metric": 0.031250014901161194,
        "tpp_threshold_5_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_5_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_10_total_metric": 0.10000000894069672,
        "tpp_threshold_10_intended_diff_only": 0.11000001430511475,
        "tpp_threshold_10_unintended_diff_only": 0.01000000536441803,
        "tpp_threshold_20_total_metric": 0.4402500241994858,
        "tpp_threshold_20_intended_diff_only": 0.46900004148483276,
        "tpp_threshold_20_unintended_diff_only": 0.028750017285346985,
        "tpp_threshold_50_total_metric": 0.4387500435113907,
        "tpp_threshold_50_intended_diff_only": 0.49000006914138794,
        "tpp_threshold_50_unintended_diff_only": 0.05125002562999725,
        "tpp_threshold_100_total_metric": 0.3435000479221344,
        "tpp_threshold_100_intended_diff_only": 0.49000006914138794,
        "tpp_threshold_100_unintended_diff_only": 0.14650002121925354,
        "tpp_threshold_500_total_metric": 0.1625000387430191,
        "tpp_threshold_500_intended_diff_only": 0.49000006914138794,
        "tpp_threshold_500_unintended_diff_only": 0.32750003039836884
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.004749983549118042,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_5_total_metric": 0.015250012278556824,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": -0.0012500137090682983,
        "tpp_threshold_10_total_metric": 0.0415000319480896,
        "tpp_threshold_10_intended_diff_only": 0.06300002336502075,
        "tpp_threshold_10_unintended_diff_only": 0.021499991416931152,
        "tpp_threshold_20_total_metric": 0.16600000858306885,
        "tpp_threshold_20_intended_diff_only": 0.25,
        "tpp_threshold_20_unintended_diff_only": 0.08399999141693115,
        "tpp_threshold_50_total_metric": 0.2787500470876694,
        "tpp_threshold_50_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_50_unintended_diff_only": 0.17525000870227814,
        "tpp_threshold_100_total_metric": 0.18050004541873932,
        "tpp_threshold_100_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_100_unintended_diff_only": 0.2735000103712082,
        "tpp_threshold_500_total_metric": 0.0532500296831131,
        "tpp_threshold_500_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_500_unintended_diff_only": 0.4007500261068344
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.020750030875205994,
        "tpp_threshold_2_intended_diff_only": 0.016000032424926758,
        "tpp_threshold_2_unintended_diff_only": -0.004749998450279236,
        "tpp_threshold_5_total_metric": 0.012500017881393433,
        "tpp_threshold_5_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_5_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_10_total_metric": 0.022750020027160645,
        "tpp_threshold_10_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_10_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_20_total_metric": 0.12025001645088196,
        "tpp_threshold_20_intended_diff_only": 0.12400001287460327,
        "tpp_threshold_20_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_50_total_metric": 0.3802500516176224,
        "tpp_threshold_50_intended_diff_only": 0.440000057220459,
        "tpp_threshold_50_unintended_diff_only": 0.05975000560283661,
        "tpp_threshold_100_total_metric": 0.2655000537633896,
        "tpp_threshold_100_intended_diff_only": 0.440000057220459,
        "tpp_threshold_100_unintended_diff_only": 0.1745000034570694,
        "tpp_threshold_500_total_metric": 0.09550002217292786,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.34450003504753113
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.005000054836273193,
        "tpp_threshold_2_intended_diff_only": -0.006000041961669922,
        "tpp_threshold_2_unintended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_total_metric": -0.015000000596046448,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.015000000596046448,
        "tpp_threshold_10_total_metric": 0.12674996256828308,
        "tpp_threshold_10_intended_diff_only": 0.1549999713897705,
        "tpp_threshold_10_unintended_diff_only": 0.028250008821487427,
        "tpp_threshold_20_total_metric": 0.2967499941587448,
        "tpp_threshold_20_intended_diff_only": 0.3500000238418579,
        "tpp_threshold_20_unintended_diff_only": 0.0532500296831131,
        "tpp_threshold_50_total_metric": 0.27675001323223114,
        "tpp_threshold_50_intended_diff_only": 0.4150000214576721,
        "tpp_threshold_50_unintended_diff_only": 0.13825000822544098,
        "tpp_threshold_100_total_metric": 0.16225001215934753,
        "tpp_threshold_100_intended_diff_only": 0.4150000214576721,
        "tpp_threshold_100_unintended_diff_only": 0.2527500092983246,
        "tpp_threshold_500_total_metric": 0.11749999225139618,
        "tpp_threshold_500_intended_diff_only": 0.4150000214576721,
        "tpp_threshold_500_unintended_diff_only": 0.29750002920627594
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.017250031232833862,
        "tpp_threshold_2_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_2_unintended_diff_only": -0.0062499940395355225,
        "tpp_threshold_5_total_metric": 0.016749992966651917,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": -0.002749994397163391,
        "tpp_threshold_10_total_metric": 0.025250032544136047,
        "tpp_threshold_10_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_10_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_20_total_metric": 0.03549998998641968,
        "tpp_threshold_20_intended_diff_only": 0.03799998760223389,
        "tpp_threshold_20_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_50_total_metric": 0.42375005781650543,
        "tpp_threshold_50_intended_diff_only": 0.440000057220459,
        "tpp_threshold_50_unintended_diff_only": 0.016249999403953552,
        "tpp_threshold_100_total_metric": 0.3027500510215759,
        "tpp_threshold_100_intended_diff_only": 0.440000057220459,
        "tpp_threshold_100_unintended_diff_only": 0.13725000619888306,
        "tpp_threshold_500_total_metric": 0.057750046253204346,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.38225001096725464
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.008750006556510925,
        "tpp_threshold_2_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": 0.0007499903440475464,
        "tpp_threshold_5_total_metric": -0.01750001311302185,
        "tpp_threshold_5_intended_diff_only": -0.018999993801116943,
        "tpp_threshold_5_unintended_diff_only": -0.0014999806880950928,
        "tpp_threshold_10_total_metric": 0.010500013828277588,
        "tpp_threshold_10_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_10_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_20_total_metric": 0.08149999380111694,
        "tpp_threshold_20_intended_diff_only": 0.09299999475479126,
        "tpp_threshold_20_unintended_diff_only": 0.011500000953674316,
        "tpp_threshold_50_total_metric": 0.34574998915195465,
        "tpp_threshold_50_intended_diff_only": 0.3659999966621399,
        "tpp_threshold_50_unintended_diff_only": 0.02025000751018524,
        "tpp_threshold_100_total_metric": 0.30125002562999725,
        "tpp_threshold_100_intended_diff_only": 0.38200002908706665,
        "tpp_threshold_100_unintended_diff_only": 0.0807500034570694,
        "tpp_threshold_500_total_metric": 0.058750003576278687,
        "tpp_threshold_500_intended_diff_only": 0.38200002908706665,
        "tpp_threshold_500_unintended_diff_only": 0.32325002551078796
      }
    }
  }
}