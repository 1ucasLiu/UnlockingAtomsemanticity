{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "dad86513-f5cc-45fc-80a2-08a73f62a4c0",
  "datetime_epoch_millis": 1767163165406,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.0015499979257583617,
      "tpp_threshold_2_intended_diff_only": 0.0024000048637390133,
      "tpp_threshold_2_unintended_diff_only": 0.0008500069379806519,
      "tpp_threshold_5_total_metric": 0.004525001347064972,
      "tpp_threshold_5_intended_diff_only": 0.005000007152557374,
      "tpp_threshold_5_unintended_diff_only": 0.0004750058054924011,
      "tpp_threshold_10_total_metric": 0.014499993622303009,
      "tpp_threshold_10_intended_diff_only": 0.016699999570846558,
      "tpp_threshold_10_unintended_diff_only": 0.002200005948543549,
      "tpp_threshold_20_total_metric": 0.026125003397464753,
      "tpp_threshold_20_intended_diff_only": 0.02850000858306885,
      "tpp_threshold_20_unintended_diff_only": 0.002375005185604096,
      "tpp_threshold_50_total_metric": 0.06417500972747803,
      "tpp_threshold_50_intended_diff_only": 0.06780001521110535,
      "tpp_threshold_50_unintended_diff_only": 0.0036250054836273193,
      "tpp_threshold_100_total_metric": 0.15060000866651535,
      "tpp_threshold_100_intended_diff_only": 0.1577000141143799,
      "tpp_threshold_100_unintended_diff_only": 0.007100005447864532,
      "tpp_threshold_500_total_metric": 0.3881000176072121,
      "tpp_threshold_500_intended_diff_only": 0.42960002422332766,
      "tpp_threshold_500_unintended_diff_only": 0.04150000661611557
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": -0.0002999991178512573,
      "tpp_threshold_2_intended_diff_only": 0.002000010013580322,
      "tpp_threshold_2_unintended_diff_only": 0.0023000091314315796,
      "tpp_threshold_5_total_metric": 0.0035999923944473266,
      "tpp_threshold_5_intended_diff_only": 0.005200004577636719,
      "tpp_threshold_5_unintended_diff_only": 0.001600012183189392,
      "tpp_threshold_10_total_metric": 0.009749990701675416,
      "tpp_threshold_10_intended_diff_only": 0.012000000476837159,
      "tpp_threshold_10_unintended_diff_only": 0.0022500097751617433,
      "tpp_threshold_20_total_metric": 0.02630000710487366,
      "tpp_threshold_20_intended_diff_only": 0.028400015830993653,
      "tpp_threshold_20_unintended_diff_only": 0.0021000087261199953,
      "tpp_threshold_50_total_metric": 0.06170000731945038,
      "tpp_threshold_50_intended_diff_only": 0.06520001888275147,
      "tpp_threshold_50_unintended_diff_only": 0.0035000115633010863,
      "tpp_threshold_100_total_metric": 0.15490001142024995,
      "tpp_threshold_100_intended_diff_only": 0.16040002107620238,
      "tpp_threshold_100_unintended_diff_only": 0.005500009655952454,
      "tpp_threshold_500_total_metric": 0.43735000491142273,
      "tpp_threshold_500_intended_diff_only": 0.4590000152587891,
      "tpp_threshold_500_unintended_diff_only": 0.021650010347366334
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.003399994969367981,
      "tpp_threshold_2_intended_diff_only": 0.002799999713897705,
      "tpp_threshold_2_unintended_diff_only": -0.0005999952554702759,
      "tpp_threshold_5_total_metric": 0.005450010299682617,
      "tpp_threshold_5_intended_diff_only": 0.0048000097274780275,
      "tpp_threshold_5_unintended_diff_only": -0.0006500005722045899,
      "tpp_threshold_10_total_metric": 0.0192499965429306,
      "tpp_threshold_10_intended_diff_only": 0.02139999866485596,
      "tpp_threshold_10_unintended_diff_only": 0.002150002121925354,
      "tpp_threshold_20_total_metric": 0.025949999690055847,
      "tpp_threshold_20_intended_diff_only": 0.028600001335144044,
      "tpp_threshold_20_unintended_diff_only": 0.002650001645088196,
      "tpp_threshold_50_total_metric": 0.06665001213550567,
      "tpp_threshold_50_intended_diff_only": 0.07040001153945923,
      "tpp_threshold_50_unintended_diff_only": 0.0037499994039535524,
      "tpp_threshold_100_total_metric": 0.14630000591278075,
      "tpp_threshold_100_intended_diff_only": 0.15500000715255738,
      "tpp_threshold_100_unintended_diff_only": 0.00870000123977661,
      "tpp_threshold_500_total_metric": 0.3388500303030014,
      "tpp_threshold_500_intended_diff_only": 0.40020003318786623,
      "tpp_threshold_500_unintended_diff_only": 0.06135000288486481
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_cos_no_eyes-1024k-BatchTopK-gemma-2-2b-resid_post_layer_4-5.0e+08-20251228_1919_resid_post_layer_4/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 18432,
    "hook_layer": 4,
    "hook_name": "blocks.4.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "batch_topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "bfloat16",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.0012499988079071045,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_5_total_metric": 0.011749997735023499,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_10_total_metric": 0.014749988913536072,
        "tpp_threshold_10_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_10_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_20_total_metric": 0.03200003504753113,
        "tpp_threshold_20_intended_diff_only": 0.03400003910064697,
        "tpp_threshold_20_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_50_total_metric": 0.06000000238418579,
        "tpp_threshold_50_intended_diff_only": 0.06499999761581421,
        "tpp_threshold_50_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_100_total_metric": 0.12350000441074371,
        "tpp_threshold_100_intended_diff_only": 0.12800002098083496,
        "tpp_threshold_100_unintended_diff_only": 0.0045000165700912476,
        "tpp_threshold_500_total_metric": 0.42900002002716064,
        "tpp_threshold_500_intended_diff_only": 0.44200003147125244,
        "tpp_threshold_500_unintended_diff_only": 0.013000011444091797
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0034999847412109375,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_5_total_metric": 0.010249942541122437,
        "tpp_threshold_5_intended_diff_only": 0.011999964714050293,
        "tpp_threshold_5_unintended_diff_only": 0.0017500221729278564,
        "tpp_threshold_10_total_metric": 0.019999951124191284,
        "tpp_threshold_10_intended_diff_only": 0.0209999680519104,
        "tpp_threshold_10_unintended_diff_only": 0.0010000169277191162,
        "tpp_threshold_20_total_metric": 0.030999988317489624,
        "tpp_threshold_20_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_20_unintended_diff_only": 0.0010000169277191162,
        "tpp_threshold_50_total_metric": 0.06674998998641968,
        "tpp_threshold_50_intended_diff_only": 0.07300001382827759,
        "tpp_threshold_50_unintended_diff_only": 0.00625002384185791,
        "tpp_threshold_100_total_metric": 0.13650000095367432,
        "tpp_threshold_100_intended_diff_only": 0.1420000195503235,
        "tpp_threshold_100_unintended_diff_only": 0.00550001859664917,
        "tpp_threshold_500_total_metric": 0.43674997985363007,
        "tpp_threshold_500_intended_diff_only": 0.44999998807907104,
        "tpp_threshold_500_unintended_diff_only": 0.013250008225440979
      },
      "2": {
        "tpp_threshold_2_total_metric": -0.0025000274181365967,
        "tpp_threshold_2_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_2_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_5_total_metric": -0.0014999955892562866,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_10_total_metric": 0.005750000476837158,
        "tpp_threshold_10_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_10_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_20_total_metric": 0.026249989867210388,
        "tpp_threshold_20_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_20_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_50_total_metric": 0.062250033020973206,
        "tpp_threshold_50_intended_diff_only": 0.06200003623962402,
        "tpp_threshold_50_unintended_diff_only": -0.00024999678134918213,
        "tpp_threshold_100_total_metric": 0.13075001537799835,
        "tpp_threshold_100_intended_diff_only": 0.13700002431869507,
        "tpp_threshold_100_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_500_total_metric": 0.42399999499320984,
        "tpp_threshold_500_intended_diff_only": 0.4440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.02000001072883606
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0007499903440475464,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_5_total_metric": 0.003000006079673767,
        "tpp_threshold_5_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_5_unintended_diff_only": 1.4901161193847656e-08,
        "tpp_threshold_10_total_metric": 0.0034999996423721313,
        "tpp_threshold_10_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_20_total_metric": 0.008749976754188538,
        "tpp_threshold_20_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_20_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_50_total_metric": 0.06699997186660767,
        "tpp_threshold_50_intended_diff_only": 0.06999999284744263,
        "tpp_threshold_50_unintended_diff_only": 0.003000020980834961,
        "tpp_threshold_100_total_metric": 0.27925001084804535,
        "tpp_threshold_100_intended_diff_only": 0.2850000262260437,
        "tpp_threshold_100_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_500_total_metric": 0.44474999606609344,
        "tpp_threshold_500_intended_diff_only": 0.48500001430511475,
        "tpp_threshold_500_unintended_diff_only": 0.0402500182390213
      },
      "9": {
        "tpp_threshold_2_total_metric": -0.0004999637603759766,
        "tpp_threshold_2_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_2_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_5_total_metric": -0.005499988794326782,
        "tpp_threshold_5_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_10_total_metric": 0.00475001335144043,
        "tpp_threshold_10_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_10_unintended_diff_only": 0.0032500028610229492,
        "tpp_threshold_20_total_metric": 0.03350004553794861,
        "tpp_threshold_20_intended_diff_only": 0.03800004720687866,
        "tpp_threshold_20_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_50_total_metric": 0.05250003933906555,
        "tpp_threshold_50_intended_diff_only": 0.05600005388259888,
        "tpp_threshold_50_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_100_total_metric": 0.10450002551078796,
        "tpp_threshold_100_intended_diff_only": 0.11000001430511475,
        "tpp_threshold_100_unintended_diff_only": 0.005499988794326782,
        "tpp_threshold_500_total_metric": 0.45225003361701965,
        "tpp_threshold_500_intended_diff_only": 0.4740000367164612,
        "tpp_threshold_500_unintended_diff_only": 0.02175000309944153
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.007500022649765015,
        "tpp_threshold_2_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_2_unintended_diff_only": -0.0004999935626983643,
        "tpp_threshold_5_total_metric": -0.001499950885772705,
        "tpp_threshold_5_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_5_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_10_total_metric": -0.0007499754428863525,
        "tpp_threshold_10_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": 0.004749983549118042,
        "tpp_threshold_20_total_metric": 0.01150001585483551,
        "tpp_threshold_20_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_20_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_50_total_metric": 0.04650002717971802,
        "tpp_threshold_50_intended_diff_only": 0.050000011920928955,
        "tpp_threshold_50_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_100_total_metric": 0.13100004196166992,
        "tpp_threshold_100_intended_diff_only": 0.14100003242492676,
        "tpp_threshold_100_unintended_diff_only": 0.009999990463256836,
        "tpp_threshold_500_total_metric": 0.36375004053115845,
        "tpp_threshold_500_intended_diff_only": 0.4360000491142273,
        "tpp_threshold_500_unintended_diff_only": 0.07225000858306885
      },
      "2": {
        "tpp_threshold_2_total_metric": -0.002500012516975403,
        "tpp_threshold_2_intended_diff_only": -0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": -0.0014999955892562866,
        "tpp_threshold_5_total_metric": -0.0004999786615371704,
        "tpp_threshold_5_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": 0.00449998676776886,
        "tpp_threshold_10_total_metric": 0.023500025272369385,
        "tpp_threshold_10_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_10_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_20_total_metric": 0.0222499817609787,
        "tpp_threshold_20_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_20_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_50_total_metric": 0.06624999642372131,
        "tpp_threshold_50_intended_diff_only": 0.07300001382827759,
        "tpp_threshold_50_unintended_diff_only": 0.006750017404556274,
        "tpp_threshold_100_total_metric": 0.12849999964237213,
        "tpp_threshold_100_intended_diff_only": 0.1380000114440918,
        "tpp_threshold_100_unintended_diff_only": 0.009500011801719666,
        "tpp_threshold_500_total_metric": 0.3162500411272049,
        "tpp_threshold_500_intended_diff_only": 0.4230000376701355,
        "tpp_threshold_500_unintended_diff_only": 0.1067499965429306
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.008250027894973755,
        "tpp_threshold_2_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_5_total_metric": -0.002750024199485779,
        "tpp_threshold_5_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_5_unintended_diff_only": -0.0052499920129776,
        "tpp_threshold_10_total_metric": 0.01124998927116394,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": -0.002249985933303833,
        "tpp_threshold_20_total_metric": 0.003500014543533325,
        "tpp_threshold_20_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_20_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_50_total_metric": 0.05375000834465027,
        "tpp_threshold_50_intended_diff_only": 0.05500000715255737,
        "tpp_threshold_50_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_100_total_metric": 0.14149999618530273,
        "tpp_threshold_100_intended_diff_only": 0.14899998903274536,
        "tpp_threshold_100_unintended_diff_only": 0.007499992847442627,
        "tpp_threshold_500_total_metric": 0.3632500320672989,
        "tpp_threshold_500_intended_diff_only": 0.39500004053115845,
        "tpp_threshold_500_unintended_diff_only": 0.03175000846385956
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.01774996519088745,
        "tpp_threshold_2_intended_diff_only": 0.015999972820281982,
        "tpp_threshold_2_unintended_diff_only": -0.0017499923706054688,
        "tpp_threshold_5_total_metric": 0.01649998128414154,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": -0.002499982714653015,
        "tpp_threshold_10_total_metric": 0.025749951601028442,
        "tpp_threshold_10_intended_diff_only": 0.02599996328353882,
        "tpp_threshold_10_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_20_total_metric": 0.03699995577335358,
        "tpp_threshold_20_intended_diff_only": 0.038999974727630615,
        "tpp_threshold_20_unintended_diff_only": 0.0020000189542770386,
        "tpp_threshold_50_total_metric": 0.06424999237060547,
        "tpp_threshold_50_intended_diff_only": 0.06999999284744263,
        "tpp_threshold_50_unintended_diff_only": 0.005750000476837158,
        "tpp_threshold_100_total_metric": 0.12299996614456177,
        "tpp_threshold_100_intended_diff_only": 0.13099998235702515,
        "tpp_threshold_100_unintended_diff_only": 0.008000016212463379,
        "tpp_threshold_500_total_metric": 0.3334999829530716,
        "tpp_threshold_500_intended_diff_only": 0.39899998903274536,
        "tpp_threshold_500_unintended_diff_only": 0.06550000607967377
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0025000274181365967,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.0004999935626983643,
        "tpp_threshold_5_total_metric": 0.0155000239610672,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": -0.002500012516975403,
        "tpp_threshold_10_total_metric": 0.0364999920129776,
        "tpp_threshold_10_intended_diff_only": 0.041999995708465576,
        "tpp_threshold_10_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_20_total_metric": 0.055500030517578125,
        "tpp_threshold_20_intended_diff_only": 0.058000028133392334,
        "tpp_threshold_20_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_50_total_metric": 0.10250003635883331,
        "tpp_threshold_50_intended_diff_only": 0.1040000319480896,
        "tpp_threshold_50_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_100_total_metric": 0.20750002562999725,
        "tpp_threshold_100_intended_diff_only": 0.2160000205039978,
        "tpp_threshold_100_unintended_diff_only": 0.00849999487400055,
        "tpp_threshold_500_total_metric": 0.3175000548362732,
        "tpp_threshold_500_intended_diff_only": 0.34800004959106445,
        "tpp_threshold_500_unintended_diff_only": 0.03049999475479126
      }
    }
  }
}