{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "05a8ce6b-11d1-40e0-ac64-6facdfcb6841",
  "datetime_epoch_millis": 1757585610454,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.004974980652332306,
      "tpp_threshold_2_intended_diff_only": 0.006099992990493774,
      "tpp_threshold_2_unintended_diff_only": 0.0011250123381614685,
      "tpp_threshold_5_total_metric": 0.0053999945521354675,
      "tpp_threshold_5_intended_diff_only": 0.005800002813339233,
      "tpp_threshold_5_unintended_diff_only": 0.0004000082612037659,
      "tpp_threshold_10_total_metric": 0.015675009787082674,
      "tpp_threshold_10_intended_diff_only": 0.017800015211105347,
      "tpp_threshold_10_unintended_diff_only": 0.0021250054240226747,
      "tpp_threshold_20_total_metric": 0.023925000429153444,
      "tpp_threshold_20_intended_diff_only": 0.026100003719329835,
      "tpp_threshold_20_unintended_diff_only": 0.0021750032901763916,
      "tpp_threshold_50_total_metric": 0.06714999526739121,
      "tpp_threshold_50_intended_diff_only": 0.06980000138282776,
      "tpp_threshold_50_unintended_diff_only": 0.002650006115436554,
      "tpp_threshold_100_total_metric": 0.16925001442432402,
      "tpp_threshold_100_intended_diff_only": 0.17660002112388612,
      "tpp_threshold_100_unintended_diff_only": 0.007350006699562072,
      "tpp_threshold_500_total_metric": 0.41200004070997237,
      "tpp_threshold_500_intended_diff_only": 0.4473000466823578,
      "tpp_threshold_500_unintended_diff_only": 0.035300005972385404
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.003699985146522522,
      "tpp_threshold_2_intended_diff_only": 0.004399991035461426,
      "tpp_threshold_2_unintended_diff_only": 0.0007000058889389038,
      "tpp_threshold_5_total_metric": 0.004699999094009399,
      "tpp_threshold_5_intended_diff_only": 0.005200004577636719,
      "tpp_threshold_5_unintended_diff_only": 0.0005000054836273194,
      "tpp_threshold_10_total_metric": 0.009400013089179992,
      "tpp_threshold_10_intended_diff_only": 0.012000024318695068,
      "tpp_threshold_10_unintended_diff_only": 0.0026000112295150755,
      "tpp_threshold_20_total_metric": 0.02175000011920929,
      "tpp_threshold_20_intended_diff_only": 0.02380000352859497,
      "tpp_threshold_20_unintended_diff_only": 0.002050003409385681,
      "tpp_threshold_50_total_metric": 0.05240000784397125,
      "tpp_threshold_50_intended_diff_only": 0.054800009727478026,
      "tpp_threshold_50_unintended_diff_only": 0.002400001883506775,
      "tpp_threshold_100_total_metric": 0.14205001294612885,
      "tpp_threshold_100_intended_diff_only": 0.14840002059936525,
      "tpp_threshold_100_unintended_diff_only": 0.006350007653236389,
      "tpp_threshold_500_total_metric": 0.4410000443458557,
      "tpp_threshold_500_intended_diff_only": 0.4700000524520874,
      "tpp_threshold_500_unintended_diff_only": 0.02900000810623169
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.00624997615814209,
      "tpp_threshold_2_intended_diff_only": 0.007799994945526123,
      "tpp_threshold_2_unintended_diff_only": 0.0015500187873840332,
      "tpp_threshold_5_total_metric": 0.006099990010261536,
      "tpp_threshold_5_intended_diff_only": 0.006400001049041748,
      "tpp_threshold_5_unintended_diff_only": 0.0003000110387802124,
      "tpp_threshold_10_total_metric": 0.02195000648498535,
      "tpp_threshold_10_intended_diff_only": 0.023600006103515626,
      "tpp_threshold_10_unintended_diff_only": 0.0016499996185302735,
      "tpp_threshold_20_total_metric": 0.026100000739097594,
      "tpp_threshold_20_intended_diff_only": 0.028400003910064697,
      "tpp_threshold_20_unintended_diff_only": 0.002300003170967102,
      "tpp_threshold_50_total_metric": 0.08189998269081115,
      "tpp_threshold_50_intended_diff_only": 0.08479999303817749,
      "tpp_threshold_50_unintended_diff_only": 0.002900010347366333,
      "tpp_threshold_100_total_metric": 0.19645001590251923,
      "tpp_threshold_100_intended_diff_only": 0.204800021648407,
      "tpp_threshold_100_unintended_diff_only": 0.008350005745887757,
      "tpp_threshold_500_total_metric": 0.38300003707408903,
      "tpp_threshold_500_intended_diff_only": 0.42460004091262815,
      "tpp_threshold_500_unintended_diff_only": 0.041600003838539124
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_hsic_BatchTopK-1024k-gemma-2-2b-2000-resid_post_layer_8-5.0e+08-20250828_2228_resid_post_layer_8/trainer_0/",
  "sae_lens_version": "5.10.7",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 18432,
    "hook_layer": 8,
    "hook_name": "blocks.8.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "batch_topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "float32",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.0007500201463699341,
        "tpp_threshold_2_intended_diff_only": 0.003000020980834961,
        "tpp_threshold_2_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_5_total_metric": 0.0032500028610229492,
        "tpp_threshold_5_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_10_total_metric": 0.00650005042552948,
        "tpp_threshold_10_intended_diff_only": 0.010000050067901611,
        "tpp_threshold_10_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_20_total_metric": 0.02250000834465027,
        "tpp_threshold_20_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_20_unintended_diff_only": 0.0004999935626983643,
        "tpp_threshold_50_total_metric": 0.06775003671646118,
        "tpp_threshold_50_intended_diff_only": 0.07100003957748413,
        "tpp_threshold_50_unintended_diff_only": 0.0032500028610229492,
        "tpp_threshold_100_total_metric": 0.18375004827976227,
        "tpp_threshold_100_intended_diff_only": 0.19000005722045898,
        "tpp_threshold_100_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_500_total_metric": 0.41200006008148193,
        "tpp_threshold_500_intended_diff_only": 0.4530000686645508,
        "tpp_threshold_500_unintended_diff_only": 0.04100000858306885
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0,
        "tpp_threshold_5_total_metric": -0.00824996829032898,
        "tpp_threshold_5_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_5_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_10_total_metric": 4.470348358154297e-08,
        "tpp_threshold_10_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_10_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_20_total_metric": 0.0017499923706054688,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_50_total_metric": 0.011000052094459534,
        "tpp_threshold_50_intended_diff_only": 0.01500004529953003,
        "tpp_threshold_50_unintended_diff_only": 0.003999993205070496,
        "tpp_threshold_100_total_metric": 0.07175002992153168,
        "tpp_threshold_100_intended_diff_only": 0.07700002193450928,
        "tpp_threshold_100_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_500_total_metric": 0.43900007009506226,
        "tpp_threshold_500_intended_diff_only": 0.4620000720024109,
        "tpp_threshold_500_unintended_diff_only": 0.023000001907348633
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.005749955773353577,
        "tpp_threshold_2_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_2_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_5_total_metric": 0.009249970316886902,
        "tpp_threshold_5_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_5_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_10_total_metric": 0.015249982476234436,
        "tpp_threshold_10_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_10_unintended_diff_only": 0.002750024199485779,
        "tpp_threshold_20_total_metric": 0.03299999237060547,
        "tpp_threshold_20_intended_diff_only": 0.03299999237060547,
        "tpp_threshold_20_unintended_diff_only": 0.0,
        "tpp_threshold_50_total_metric": 0.056000009179115295,
        "tpp_threshold_50_intended_diff_only": 0.05500000715255737,
        "tpp_threshold_50_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_100_total_metric": 0.16324996948242188,
        "tpp_threshold_100_intended_diff_only": 0.16699999570846558,
        "tpp_threshold_100_unintended_diff_only": 0.003750026226043701,
        "tpp_threshold_500_total_metric": 0.43825002014636993,
        "tpp_threshold_500_intended_diff_only": 0.46000003814697266,
        "tpp_threshold_500_unintended_diff_only": 0.021750018000602722
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.007249966263771057,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": -0.0012499839067459106,
        "tpp_threshold_5_total_metric": 0.007999986410140991,
        "tpp_threshold_5_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": -0.0029999911785125732,
        "tpp_threshold_10_total_metric": 0.008000001311302185,
        "tpp_threshold_10_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_10_unintended_diff_only": 1.4901161193847656e-08,
        "tpp_threshold_20_total_metric": 0.009499981999397278,
        "tpp_threshold_20_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_20_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_50_total_metric": 0.012999966740608215,
        "tpp_threshold_50_intended_diff_only": 0.011999964714050293,
        "tpp_threshold_50_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_100_total_metric": 0.027250006794929504,
        "tpp_threshold_100_intended_diff_only": 0.03100001811981201,
        "tpp_threshold_100_unintended_diff_only": 0.0037500113248825073,
        "tpp_threshold_500_total_metric": 0.4735000282526016,
        "tpp_threshold_500_intended_diff_only": 0.4970000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.02350001037120819
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.004749983549118042,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_5_total_metric": 0.011250004172325134,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_10_total_metric": 0.01724998652935028,
        "tpp_threshold_10_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_10_unintended_diff_only": 0.005750015377998352,
        "tpp_threshold_20_total_metric": 0.042000025510787964,
        "tpp_threshold_20_intended_diff_only": 0.04900002479553223,
        "tpp_threshold_20_unintended_diff_only": 0.006999999284744263,
        "tpp_threshold_50_total_metric": 0.11424997448921204,
        "tpp_threshold_50_intended_diff_only": 0.12099999189376831,
        "tpp_threshold_50_unintended_diff_only": 0.006750017404556274,
        "tpp_threshold_100_total_metric": 0.2642500102519989,
        "tpp_threshold_100_intended_diff_only": 0.2770000100135803,
        "tpp_threshold_100_unintended_diff_only": 0.012749999761581421,
        "tpp_threshold_500_total_metric": 0.4422500431537628,
        "tpp_threshold_500_intended_diff_only": 0.47800004482269287,
        "tpp_threshold_500_unintended_diff_only": 0.035750001668930054
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.004749968647956848,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_5_total_metric": -4.470348358154297e-08,
        "tpp_threshold_5_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_5_unintended_diff_only": 0.0020000189542770386,
        "tpp_threshold_10_total_metric": 0.0102500319480896,
        "tpp_threshold_10_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_10_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_20_total_metric": 0.02350001037120819,
        "tpp_threshold_20_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_20_unintended_diff_only": -0.0014999955892562866,
        "tpp_threshold_50_total_metric": 0.057999998331069946,
        "tpp_threshold_50_intended_diff_only": 0.06000000238418579,
        "tpp_threshold_50_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_100_total_metric": 0.15825001895427704,
        "tpp_threshold_100_intended_diff_only": 0.1690000295639038,
        "tpp_threshold_100_unintended_diff_only": 0.01075001060962677,
        "tpp_threshold_500_total_metric": 0.4097500443458557,
        "tpp_threshold_500_intended_diff_only": 0.4500000476837158,
        "tpp_threshold_500_unintended_diff_only": 0.04025000333786011
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.01174996793270111,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": -0.001749977469444275,
        "tpp_threshold_5_total_metric": 0.003999993205070496,
        "tpp_threshold_5_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_5_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_10_total_metric": 0.02249997854232788,
        "tpp_threshold_10_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_10_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_20_total_metric": 0.0337500125169754,
        "tpp_threshold_20_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_20_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_50_total_metric": 0.09549999237060547,
        "tpp_threshold_50_intended_diff_only": 0.09700000286102295,
        "tpp_threshold_50_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_100_total_metric": 0.22075003385543823,
        "tpp_threshold_100_intended_diff_only": 0.2290000319480896,
        "tpp_threshold_100_unintended_diff_only": 0.008249998092651367,
        "tpp_threshold_500_total_metric": 0.38550005853176117,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.054499998688697815
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.01400001347064972,
        "tpp_threshold_2_intended_diff_only": -0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_5_total_metric": -0.00550001859664917,
        "tpp_threshold_5_intended_diff_only": -0.009000003337860107,
        "tpp_threshold_5_unintended_diff_only": -0.0034999847412109375,
        "tpp_threshold_10_total_metric": 0.014500007033348083,
        "tpp_threshold_10_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_10_unintended_diff_only": -0.0005000084638595581,
        "tpp_threshold_20_total_metric": -0.00599999725818634,
        "tpp_threshold_20_intended_diff_only": -0.0009999871253967285,
        "tpp_threshold_20_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_50_total_metric": 0.025999993085861206,
        "tpp_threshold_50_intended_diff_only": 0.02799999713897705,
        "tpp_threshold_50_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_100_total_metric": 0.10900002717971802,
        "tpp_threshold_100_intended_diff_only": 0.11300003528594971,
        "tpp_threshold_100_unintended_diff_only": 0.0040000081062316895,
        "tpp_threshold_500_total_metric": 0.3947500139474869,
        "tpp_threshold_500_intended_diff_only": 0.42000001668930054,
        "tpp_threshold_500_unintended_diff_only": 0.02525000274181366
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.021250009536743164,
        "tpp_threshold_2_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_2_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_5_total_metric": 0.025250017642974854,
        "tpp_threshold_5_intended_diff_only": 0.025000035762786865,
        "tpp_threshold_5_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_10_total_metric": 0.03600004315376282,
        "tpp_threshold_10_intended_diff_only": 0.03900003433227539,
        "tpp_threshold_10_unintended_diff_only": 0.0029999911785125732,
        "tpp_threshold_20_total_metric": 0.049749985337257385,
        "tpp_threshold_20_intended_diff_only": 0.05199998617172241,
        "tpp_threshold_20_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_50_total_metric": 0.1264999657869339,
        "tpp_threshold_50_intended_diff_only": 0.12999999523162842,
        "tpp_threshold_50_unintended_diff_only": 0.003500029444694519,
        "tpp_threshold_100_total_metric": 0.22350002825260162,
        "tpp_threshold_100_intended_diff_only": 0.23400002717971802,
        "tpp_threshold_100_unintended_diff_only": 0.010499998927116394,
        "tpp_threshold_500_total_metric": 0.3757500499486923,
        "tpp_threshold_500_intended_diff_only": 0.4310000538825989,
        "tpp_threshold_500_unintended_diff_only": 0.055250003933906555
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.007499948143959045,
        "tpp_threshold_2_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_2_unintended_diff_only": 0.003500029444694519,
        "tpp_threshold_5_total_metric": 0.006750002503395081,
        "tpp_threshold_5_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_5_unintended_diff_only": -0.002749994397163391,
        "tpp_threshold_10_total_metric": 0.026499971747398376,
        "tpp_threshold_10_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_10_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_20_total_metric": 0.029499992728233337,
        "tpp_threshold_20_intended_diff_only": 0.03299999237060547,
        "tpp_threshold_20_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_50_total_metric": 0.10349996387958527,
        "tpp_threshold_50_intended_diff_only": 0.10899996757507324,
        "tpp_threshold_50_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_100_total_metric": 0.2707499712705612,
        "tpp_threshold_100_intended_diff_only": 0.2789999842643738,
        "tpp_threshold_100_unintended_diff_only": 0.008250012993812561,
        "tpp_threshold_500_total_metric": 0.34925001859664917,
        "tpp_threshold_500_intended_diff_only": 0.38200002908706665,
        "tpp_threshold_500_unintended_diff_only": 0.03275001049041748
      }
    }
  }
}