{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-9b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "0686b281-8ed3-4471-a98a-f3ba16a242bf",
  "datetime_epoch_millis": 1761461753241,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.001999996602535248,
      "tpp_threshold_2_intended_diff_only": 0.0026000022888183595,
      "tpp_threshold_2_unintended_diff_only": 0.0006000056862831115,
      "tpp_threshold_5_total_metric": 0.004625006020069123,
      "tpp_threshold_5_intended_diff_only": 0.005500006675720215,
      "tpp_threshold_5_unintended_diff_only": 0.0008750006556510926,
      "tpp_threshold_10_total_metric": 0.012900006771087645,
      "tpp_threshold_10_intended_diff_only": 0.015500009059906006,
      "tpp_threshold_10_unintended_diff_only": 0.0026000022888183595,
      "tpp_threshold_20_total_metric": 0.0216249942779541,
      "tpp_threshold_20_intended_diff_only": 0.024400001764297484,
      "tpp_threshold_20_unintended_diff_only": 0.0027750074863433834,
      "tpp_threshold_50_total_metric": 0.06372500360012054,
      "tpp_threshold_50_intended_diff_only": 0.06750000715255738,
      "tpp_threshold_50_unintended_diff_only": 0.003775003552436829,
      "tpp_threshold_100_total_metric": 0.173825004696846,
      "tpp_threshold_100_intended_diff_only": 0.18040000796318056,
      "tpp_threshold_100_unintended_diff_only": 0.006575003266334534,
      "tpp_threshold_500_total_metric": 0.4228500336408615,
      "tpp_threshold_500_intended_diff_only": 0.44780004024505615,
      "tpp_threshold_500_unintended_diff_only": 0.024950006604194643
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.0009500026702880859,
      "tpp_threshold_2_intended_diff_only": 0.0038000106811523437,
      "tpp_threshold_2_unintended_diff_only": 0.0028500080108642576,
      "tpp_threshold_5_total_metric": 0.004499998688697815,
      "tpp_threshold_5_intended_diff_only": 0.007200002670288086,
      "tpp_threshold_5_unintended_diff_only": 0.002700003981590271,
      "tpp_threshold_10_total_metric": 0.008800002932548522,
      "tpp_threshold_10_intended_diff_only": 0.012000012397766113,
      "tpp_threshold_10_unintended_diff_only": 0.0032000094652175903,
      "tpp_threshold_20_total_metric": 0.019849991798400878,
      "tpp_threshold_20_intended_diff_only": 0.02380000352859497,
      "tpp_threshold_20_unintended_diff_only": 0.003950011730194092,
      "tpp_threshold_50_total_metric": 0.04970000386238098,
      "tpp_threshold_50_intended_diff_only": 0.05400000810623169,
      "tpp_threshold_50_unintended_diff_only": 0.004300004243850708,
      "tpp_threshold_100_total_metric": 0.17210000157356262,
      "tpp_threshold_100_intended_diff_only": 0.17780001163482667,
      "tpp_threshold_100_unintended_diff_only": 0.005700010061264038,
      "tpp_threshold_500_total_metric": 0.4550500363111496,
      "tpp_threshold_500_intended_diff_only": 0.4696000456809998,
      "tpp_threshold_500_unintended_diff_only": 0.014550009369850158
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0030499905347824096,
      "tpp_threshold_2_intended_diff_only": 0.001399993896484375,
      "tpp_threshold_2_unintended_diff_only": -0.0016499966382980346,
      "tpp_threshold_5_total_metric": 0.00475001335144043,
      "tpp_threshold_5_intended_diff_only": 0.0038000106811523437,
      "tpp_threshold_5_unintended_diff_only": -0.0009500026702880859,
      "tpp_threshold_10_total_metric": 0.01700001060962677,
      "tpp_threshold_10_intended_diff_only": 0.0190000057220459,
      "tpp_threshold_10_unintended_diff_only": 0.0019999951124191283,
      "tpp_threshold_20_total_metric": 0.023399996757507324,
      "tpp_threshold_20_intended_diff_only": 0.025,
      "tpp_threshold_20_unintended_diff_only": 0.0016000032424926757,
      "tpp_threshold_50_total_metric": 0.07775000333786011,
      "tpp_threshold_50_intended_diff_only": 0.08100000619888306,
      "tpp_threshold_50_unintended_diff_only": 0.0032500028610229492,
      "tpp_threshold_100_total_metric": 0.1755500078201294,
      "tpp_threshold_100_intended_diff_only": 0.18300000429153443,
      "tpp_threshold_100_unintended_diff_only": 0.007449996471405029,
      "tpp_threshold_500_total_metric": 0.39065003097057344,
      "tpp_threshold_500_intended_diff_only": 0.4260000348091125,
      "tpp_threshold_500_unintended_diff_only": 0.035350003838539125
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_hsic-1536k-sample-gemma-2-9b-resid_post_layer_8-5.0e+08-20251022_1331_resid_post_layer_8/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-9b",
    "d_in": 3584,
    "d_sae": 28672,
    "hook_layer": 8,
    "hook_name": "blocks.8.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "float32",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.0034999698400497437,
        "tpp_threshold_2_intended_diff_only": 0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_5_total_metric": 0.00625002384185791,
        "tpp_threshold_5_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_5_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_10_total_metric": 0.015750035643577576,
        "tpp_threshold_10_intended_diff_only": 0.020000040531158447,
        "tpp_threshold_10_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_20_total_metric": 0.031999990344047546,
        "tpp_threshold_20_intended_diff_only": 0.03600001335144043,
        "tpp_threshold_20_unintended_diff_only": 0.004000023007392883,
        "tpp_threshold_50_total_metric": 0.06350003182888031,
        "tpp_threshold_50_intended_diff_only": 0.07200002670288086,
        "tpp_threshold_50_unintended_diff_only": 0.00849999487400055,
        "tpp_threshold_100_total_metric": 0.17400002479553223,
        "tpp_threshold_100_intended_diff_only": 0.17900002002716064,
        "tpp_threshold_100_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_500_total_metric": 0.44050006568431854,
        "tpp_threshold_500_intended_diff_only": 0.4580000638961792,
        "tpp_threshold_500_unintended_diff_only": 0.017499998211860657
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.004250049591064453,
        "tpp_threshold_2_intended_diff_only": 0.006000041961669922,
        "tpp_threshold_2_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_5_total_metric": -0.002499997615814209,
        "tpp_threshold_5_intended_diff_only": 0.0,
        "tpp_threshold_5_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_10_total_metric": -0.004249975085258484,
        "tpp_threshold_10_intended_diff_only": -0.0029999613761901855,
        "tpp_threshold_10_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_20_total_metric": -0.0004999935626983643,
        "tpp_threshold_20_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_20_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_50_total_metric": 0.018000051379203796,
        "tpp_threshold_50_intended_diff_only": 0.024000048637390137,
        "tpp_threshold_50_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_100_total_metric": 0.08499999344348907,
        "tpp_threshold_100_intended_diff_only": 0.09200000762939453,
        "tpp_threshold_100_unintended_diff_only": 0.0070000141859054565,
        "tpp_threshold_500_total_metric": 0.4410000145435333,
        "tpp_threshold_500_intended_diff_only": 0.4570000171661377,
        "tpp_threshold_500_unintended_diff_only": 0.01600000262260437
      },
      "2": {
        "tpp_threshold_2_total_metric": -0.005250021815299988,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.005250021815299988,
        "tpp_threshold_5_total_metric": 0.004500001668930054,
        "tpp_threshold_5_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_5_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_10_total_metric": 0.006999999284744263,
        "tpp_threshold_10_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_10_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_20_total_metric": 0.014750033617019653,
        "tpp_threshold_20_intended_diff_only": 0.020000040531158447,
        "tpp_threshold_20_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_50_total_metric": 0.04399996995925903,
        "tpp_threshold_50_intended_diff_only": 0.046999990940093994,
        "tpp_threshold_50_unintended_diff_only": 0.003000020980834961,
        "tpp_threshold_100_total_metric": 0.13875001668930054,
        "tpp_threshold_100_intended_diff_only": 0.14600002765655518,
        "tpp_threshold_100_unintended_diff_only": 0.007250010967254639,
        "tpp_threshold_500_total_metric": 0.442500039935112,
        "tpp_threshold_500_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_500_unintended_diff_only": 0.01150001585483551
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0004999637603759766,
        "tpp_threshold_2_intended_diff_only": 0.001999974250793457,
        "tpp_threshold_2_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_5_total_metric": 0.0027499794960021973,
        "tpp_threshold_5_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_10_total_metric": 0.005999952554702759,
        "tpp_threshold_10_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_10_unintended_diff_only": 0.0010000169277191162,
        "tpp_threshold_20_total_metric": 0.011249929666519165,
        "tpp_threshold_20_intended_diff_only": 0.012999951839447021,
        "tpp_threshold_20_unintended_diff_only": 0.0017500221729278564,
        "tpp_threshold_50_total_metric": 0.03949993848800659,
        "tpp_threshold_50_intended_diff_only": 0.04099994897842407,
        "tpp_threshold_50_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_100_total_metric": 0.30924998223781586,
        "tpp_threshold_100_intended_diff_only": 0.3100000023841858,
        "tpp_threshold_100_unintended_diff_only": 0.0007500201463699341,
        "tpp_threshold_500_total_metric": 0.4804999977350235,
        "tpp_threshold_500_intended_diff_only": 0.48900002241134644,
        "tpp_threshold_500_unintended_diff_only": 0.008500024676322937
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.008749991655349731,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_5_total_metric": 0.011499986052513123,
        "tpp_threshold_5_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_5_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_10_total_metric": 0.0195000022649765,
        "tpp_threshold_10_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_10_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_20_total_metric": 0.041749998927116394,
        "tpp_threshold_20_intended_diff_only": 0.046000003814697266,
        "tpp_threshold_20_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_50_total_metric": 0.08350002765655518,
        "tpp_threshold_50_intended_diff_only": 0.08600002527236938,
        "tpp_threshold_50_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_100_total_metric": 0.15349999070167542,
        "tpp_threshold_100_intended_diff_only": 0.16200000047683716,
        "tpp_threshold_100_unintended_diff_only": 0.008500009775161743,
        "tpp_threshold_500_total_metric": 0.4707500636577606,
        "tpp_threshold_500_intended_diff_only": 0.49000006914138794,
        "tpp_threshold_500_unintended_diff_only": 0.01925000548362732
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.005499973893165588,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0005000084638595581,
        "tpp_threshold_5_total_metric": 0.010000035166740417,
        "tpp_threshold_5_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_5_unintended_diff_only": -0.003000006079673767,
        "tpp_threshold_10_total_metric": 0.008749991655349731,
        "tpp_threshold_10_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_10_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_20_total_metric": 0.02300003170967102,
        "tpp_threshold_20_intended_diff_only": 0.020000040531158447,
        "tpp_threshold_20_unintended_diff_only": -0.0029999911785125732,
        "tpp_threshold_50_total_metric": 0.04775001108646393,
        "tpp_threshold_50_intended_diff_only": 0.050000011920928955,
        "tpp_threshold_50_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_100_total_metric": 0.10175000131130219,
        "tpp_threshold_100_intended_diff_only": 0.10699999332427979,
        "tpp_threshold_100_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_500_total_metric": 0.41200001537799835,
        "tpp_threshold_500_intended_diff_only": 0.453000009059906,
        "tpp_threshold_500_unintended_diff_only": 0.040999993681907654
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.015250042080879211,
        "tpp_threshold_2_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_2_unintended_diff_only": -0.003250017762184143,
        "tpp_threshold_5_total_metric": 0.007500052452087402,
        "tpp_threshold_5_intended_diff_only": 0.01100003719329834,
        "tpp_threshold_5_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_10_total_metric": 0.021500051021575928,
        "tpp_threshold_10_intended_diff_only": 0.025000035762786865,
        "tpp_threshold_10_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_20_total_metric": 0.02699999511241913,
        "tpp_threshold_20_intended_diff_only": 0.02899998426437378,
        "tpp_threshold_20_unintended_diff_only": 0.001999989151954651,
        "tpp_threshold_50_total_metric": 0.07925000786781311,
        "tpp_threshold_50_intended_diff_only": 0.0820000171661377,
        "tpp_threshold_50_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_100_total_metric": 0.1977500468492508,
        "tpp_threshold_100_intended_diff_only": 0.20600003004074097,
        "tpp_threshold_100_unintended_diff_only": 0.008249983191490173,
        "tpp_threshold_500_total_metric": 0.4140000492334366,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.0260000079870224
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.010500043630599976,
        "tpp_threshold_2_intended_diff_only": -0.01100003719329834,
        "tpp_threshold_2_unintended_diff_only": -0.0004999935626983643,
        "tpp_threshold_5_total_metric": -0.008250012993812561,
        "tpp_threshold_5_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_5_unintended_diff_only": 0.00024999678134918213,
        "tpp_threshold_10_total_metric": 0.0057499706745147705,
        "tpp_threshold_10_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_10_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_20_total_metric": -0.009000048041343689,
        "tpp_threshold_20_intended_diff_only": -0.00700002908706665,
        "tpp_threshold_20_unintended_diff_only": 0.0020000189542770386,
        "tpp_threshold_50_total_metric": 0.00949995219707489,
        "tpp_threshold_50_intended_diff_only": 0.011999964714050293,
        "tpp_threshold_50_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_100_total_metric": 0.06624998152256012,
        "tpp_threshold_100_intended_diff_only": 0.07099997997283936,
        "tpp_threshold_100_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_500_total_metric": 0.39275000989437103,
        "tpp_threshold_500_intended_diff_only": 0.4150000214576721,
        "tpp_threshold_500_unintended_diff_only": 0.022250011563301086
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.015250012278556824,
        "tpp_threshold_2_intended_diff_only": 0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": -0.007249996066093445,
        "tpp_threshold_5_total_metric": 0.02500002086162567,
        "tpp_threshold_5_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_5_unintended_diff_only": -0.003999993205070496,
        "tpp_threshold_10_total_metric": 0.033500030636787415,
        "tpp_threshold_10_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_10_unintended_diff_only": 0.0014999955892562866,
        "tpp_threshold_20_total_metric": 0.054750025272369385,
        "tpp_threshold_20_intended_diff_only": 0.05900001525878906,
        "tpp_threshold_20_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_50_total_metric": 0.13600003719329834,
        "tpp_threshold_50_intended_diff_only": 0.14100003242492676,
        "tpp_threshold_50_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_100_total_metric": 0.2942500412464142,
        "tpp_threshold_100_intended_diff_only": 0.3070000410079956,
        "tpp_threshold_100_unintended_diff_only": 0.012749999761581421,
        "tpp_threshold_500_total_metric": 0.3785000443458557,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.06150001287460327
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.0102500319480896,
        "tpp_threshold_2_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_5_total_metric": -0.010500028729438782,
        "tpp_threshold_5_intended_diff_only": -0.012000024318695068,
        "tpp_threshold_5_unintended_diff_only": -0.0014999955892562866,
        "tpp_threshold_10_total_metric": 0.015500009059906006,
        "tpp_threshold_10_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_10_unintended_diff_only": 0.0034999847412109375,
        "tpp_threshold_20_total_metric": 0.021249979734420776,
        "tpp_threshold_20_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_20_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_50_total_metric": 0.11625000834465027,
        "tpp_threshold_50_intended_diff_only": 0.12000000476837158,
        "tpp_threshold_50_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_100_total_metric": 0.2177499681711197,
        "tpp_threshold_100_intended_diff_only": 0.2239999771118164,
        "tpp_threshold_100_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_500_total_metric": 0.35600003600120544,
        "tpp_threshold_500_intended_diff_only": 0.38200002908706665,
        "tpp_threshold_500_unintended_diff_only": 0.025999993085861206
      }
    }
  }
}