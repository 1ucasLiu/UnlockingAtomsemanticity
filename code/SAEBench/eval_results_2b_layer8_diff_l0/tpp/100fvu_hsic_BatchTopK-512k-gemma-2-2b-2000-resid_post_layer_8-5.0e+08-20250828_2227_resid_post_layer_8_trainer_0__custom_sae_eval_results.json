{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-2b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "3500d599-f1a9-4249-aace-8116ecf262af",
  "datetime_epoch_millis": 1757583650356,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.005999994277954101,
      "tpp_threshold_2_intended_diff_only": 0.007400000095367431,
      "tpp_threshold_2_unintended_diff_only": 0.00140000581741333,
      "tpp_threshold_5_total_metric": 0.010700003802776338,
      "tpp_threshold_5_intended_diff_only": 0.01190001368522644,
      "tpp_threshold_5_unintended_diff_only": 0.0012000098824501038,
      "tpp_threshold_10_total_metric": 0.021549998223781584,
      "tpp_threshold_10_intended_diff_only": 0.024900001287460328,
      "tpp_threshold_10_unintended_diff_only": 0.0033500030636787414,
      "tpp_threshold_20_total_metric": 0.03345001339912415,
      "tpp_threshold_20_intended_diff_only": 0.03630001544952392,
      "tpp_threshold_20_unintended_diff_only": 0.0028500020503997806,
      "tpp_threshold_50_total_metric": 0.08212500065565109,
      "tpp_threshold_50_intended_diff_only": 0.08590000867843628,
      "tpp_threshold_50_unintended_diff_only": 0.0037750080227851868,
      "tpp_threshold_100_total_metric": 0.18242501765489577,
      "tpp_threshold_100_intended_diff_only": 0.19000002145767214,
      "tpp_threshold_100_unintended_diff_only": 0.007575003802776337,
      "tpp_threshold_500_total_metric": 0.4257250383496285,
      "tpp_threshold_500_intended_diff_only": 0.44710004329681396,
      "tpp_threshold_500_unintended_diff_only": 0.021375004947185517
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.004949983954429626,
      "tpp_threshold_2_intended_diff_only": 0.006399989128112793,
      "tpp_threshold_2_unintended_diff_only": 0.0014500051736831665,
      "tpp_threshold_5_total_metric": 0.008250010013580323,
      "tpp_threshold_5_intended_diff_only": 0.0098000168800354,
      "tpp_threshold_5_unintended_diff_only": 0.001550006866455078,
      "tpp_threshold_10_total_metric": 0.01615000069141388,
      "tpp_threshold_10_intended_diff_only": 0.019800007343292236,
      "tpp_threshold_10_unintended_diff_only": 0.0036500066518783568,
      "tpp_threshold_20_total_metric": 0.03235001266002655,
      "tpp_threshold_20_intended_diff_only": 0.03500001430511475,
      "tpp_threshold_20_unintended_diff_only": 0.002650001645088196,
      "tpp_threshold_50_total_metric": 0.07500000894069672,
      "tpp_threshold_50_intended_diff_only": 0.07860001325607299,
      "tpp_threshold_50_unintended_diff_only": 0.003600004315376282,
      "tpp_threshold_100_total_metric": 0.1816500186920166,
      "tpp_threshold_100_intended_diff_only": 0.18900002241134645,
      "tpp_threshold_100_unintended_diff_only": 0.007350003719329834,
      "tpp_threshold_500_total_metric": 0.4552000403404236,
      "tpp_threshold_500_intended_diff_only": 0.4696000456809998,
      "tpp_threshold_500_unintended_diff_only": 0.014400005340576172
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.0070500046014785765,
      "tpp_threshold_2_intended_diff_only": 0.00840001106262207,
      "tpp_threshold_2_unintended_diff_only": 0.0013500064611434936,
      "tpp_threshold_5_total_metric": 0.013149997591972351,
      "tpp_threshold_5_intended_diff_only": 0.014000010490417481,
      "tpp_threshold_5_unintended_diff_only": 0.0008500128984451294,
      "tpp_threshold_10_total_metric": 0.026949995756149293,
      "tpp_threshold_10_intended_diff_only": 0.02999999523162842,
      "tpp_threshold_10_unintended_diff_only": 0.003049999475479126,
      "tpp_threshold_20_total_metric": 0.034550014138221743,
      "tpp_threshold_20_intended_diff_only": 0.037600016593933104,
      "tpp_threshold_20_unintended_diff_only": 0.003050002455711365,
      "tpp_threshold_50_total_metric": 0.08924999237060546,
      "tpp_threshold_50_intended_diff_only": 0.09320000410079957,
      "tpp_threshold_50_unintended_diff_only": 0.003950011730194092,
      "tpp_threshold_100_total_metric": 0.18320001661777496,
      "tpp_threshold_100_intended_diff_only": 0.1910000205039978,
      "tpp_threshold_100_unintended_diff_only": 0.00780000388622284,
      "tpp_threshold_500_total_metric": 0.3962500363588333,
      "tpp_threshold_500_intended_diff_only": 0.42460004091262815,
      "tpp_threshold_500_unintended_diff_only": 0.028350004553794862
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_hsic_BatchTopK-512k-gemma-2-2b-2000-resid_post_layer_8-5.0e+08-20250828_2227_resid_post_layer_8/trainer_0/",
  "sae_lens_version": "5.10.7",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-2b",
    "d_in": 2304,
    "d_sae": 18432,
    "hook_layer": 8,
    "hook_name": "blocks.8.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "batch_topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "float32",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": 0.004749998450279236,
        "tpp_threshold_2_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_2_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_5_total_metric": 0.013500034809112549,
        "tpp_threshold_5_intended_diff_only": 0.016000032424926758,
        "tpp_threshold_5_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_10_total_metric": 0.01625002920627594,
        "tpp_threshold_10_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_10_unintended_diff_only": 0.004749998450279236,
        "tpp_threshold_20_total_metric": 0.03275004029273987,
        "tpp_threshold_20_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_20_unintended_diff_only": 0.002249985933303833,
        "tpp_threshold_50_total_metric": 0.07375001907348633,
        "tpp_threshold_50_intended_diff_only": 0.07700002193450928,
        "tpp_threshold_50_unintended_diff_only": 0.0032500028610229492,
        "tpp_threshold_100_total_metric": 0.19025002419948578,
        "tpp_threshold_100_intended_diff_only": 0.19700002670288086,
        "tpp_threshold_100_unintended_diff_only": 0.006750002503395081,
        "tpp_threshold_500_total_metric": 0.4345000684261322,
        "tpp_threshold_500_intended_diff_only": 0.4530000686645508,
        "tpp_threshold_500_unintended_diff_only": 0.01850000023841858
      },
      "1": {
        "tpp_threshold_2_total_metric": 0.0,
        "tpp_threshold_2_intended_diff_only": 0.0,
        "tpp_threshold_2_unintended_diff_only": 0.0,
        "tpp_threshold_5_total_metric": -0.00824996829032898,
        "tpp_threshold_5_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_5_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_10_total_metric": -0.0004999637603759766,
        "tpp_threshold_10_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_10_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_20_total_metric": 0.0047500282526016235,
        "tpp_threshold_20_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_20_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_50_total_metric": 0.014500051736831665,
        "tpp_threshold_50_intended_diff_only": 0.01900005340576172,
        "tpp_threshold_50_unintended_diff_only": 0.004500001668930054,
        "tpp_threshold_100_total_metric": 0.04600004851818085,
        "tpp_threshold_100_intended_diff_only": 0.05200004577636719,
        "tpp_threshold_100_unintended_diff_only": 0.00599999725818634,
        "tpp_threshold_500_total_metric": 0.44725003838539124,
        "tpp_threshold_500_intended_diff_only": 0.46000003814697266,
        "tpp_threshold_500_unintended_diff_only": 0.012749999761581421
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.004499971866607666,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_5_total_metric": 0.01400001347064972,
        "tpp_threshold_5_intended_diff_only": 0.017000019550323486,
        "tpp_threshold_5_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_10_total_metric": 0.026499956846237183,
        "tpp_threshold_10_intended_diff_only": 0.029999971389770508,
        "tpp_threshold_10_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_20_total_metric": 0.051749974489212036,
        "tpp_threshold_20_intended_diff_only": 0.05199998617172241,
        "tpp_threshold_20_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_50_total_metric": 0.09324996173381805,
        "tpp_threshold_50_intended_diff_only": 0.09499996900558472,
        "tpp_threshold_50_unintended_diff_only": 0.0017500072717666626,
        "tpp_threshold_100_total_metric": 0.2032500058412552,
        "tpp_threshold_100_intended_diff_only": 0.2120000123977661,
        "tpp_threshold_100_unintended_diff_only": 0.008750006556510925,
        "tpp_threshold_500_total_metric": 0.4465000331401825,
        "tpp_threshold_500_intended_diff_only": 0.46000003814697266,
        "tpp_threshold_500_unintended_diff_only": 0.013500005006790161
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.006999969482421875,
        "tpp_threshold_2_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_2_unintended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_total_metric": 0.007999986410140991,
        "tpp_threshold_5_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": -0.0029999911785125732,
        "tpp_threshold_10_total_metric": 0.008749991655349731,
        "tpp_threshold_10_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_10_unintended_diff_only": 0.000250011682510376,
        "tpp_threshold_20_total_metric": 0.007750004529953003,
        "tpp_threshold_20_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_20_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_50_total_metric": 0.021250009536743164,
        "tpp_threshold_50_intended_diff_only": 0.022000014781951904,
        "tpp_threshold_50_unintended_diff_only": 0.0007500052452087402,
        "tpp_threshold_100_total_metric": 0.15274997055530548,
        "tpp_threshold_100_intended_diff_only": 0.15399998426437378,
        "tpp_threshold_100_unintended_diff_only": 0.0012500137090682983,
        "tpp_threshold_500_total_metric": 0.4950000196695328,
        "tpp_threshold_500_intended_diff_only": 0.4970000386238098,
        "tpp_threshold_500_unintended_diff_only": 0.0020000189542770386
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.008499979972839355,
        "tpp_threshold_2_intended_diff_only": 0.010999977588653564,
        "tpp_threshold_2_unintended_diff_only": 0.002499997615814209,
        "tpp_threshold_5_total_metric": 0.013999983668327332,
        "tpp_threshold_5_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_5_unintended_diff_only": 0.005000010132789612,
        "tpp_threshold_10_total_metric": 0.02974998950958252,
        "tpp_threshold_10_intended_diff_only": 0.03799998760223389,
        "tpp_threshold_10_unintended_diff_only": 0.008249998092651367,
        "tpp_threshold_20_total_metric": 0.06475001573562622,
        "tpp_threshold_20_intended_diff_only": 0.07200002670288086,
        "tpp_threshold_20_unintended_diff_only": 0.007250010967254639,
        "tpp_threshold_50_total_metric": 0.17225000262260437,
        "tpp_threshold_50_intended_diff_only": 0.18000000715255737,
        "tpp_threshold_50_unintended_diff_only": 0.007750004529953003,
        "tpp_threshold_100_total_metric": 0.3160000443458557,
        "tpp_threshold_100_intended_diff_only": 0.33000004291534424,
        "tpp_threshold_100_unintended_diff_only": 0.013999998569488525,
        "tpp_threshold_500_total_metric": 0.4527500420808792,
        "tpp_threshold_500_intended_diff_only": 0.47800004482269287,
        "tpp_threshold_500_unintended_diff_only": 0.02525000274181366
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.005750030279159546,
        "tpp_threshold_2_intended_diff_only": 0.00700002908706665,
        "tpp_threshold_2_unintended_diff_only": 0.0012499988079071045,
        "tpp_threshold_5_total_metric": 0.007749974727630615,
        "tpp_threshold_5_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_5_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_10_total_metric": 0.01524999737739563,
        "tpp_threshold_10_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_10_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_20_total_metric": 0.026499971747398376,
        "tpp_threshold_20_intended_diff_only": 0.02499997615814209,
        "tpp_threshold_20_unintended_diff_only": -0.0014999955892562866,
        "tpp_threshold_50_total_metric": 0.05899995565414429,
        "tpp_threshold_50_intended_diff_only": 0.06199997663497925,
        "tpp_threshold_50_unintended_diff_only": 0.003000020980834961,
        "tpp_threshold_100_total_metric": 0.13850000500679016,
        "tpp_threshold_100_intended_diff_only": 0.1470000147819519,
        "tpp_threshold_100_unintended_diff_only": 0.008500009775161743,
        "tpp_threshold_500_total_metric": 0.42625004053115845,
        "tpp_threshold_500_intended_diff_only": 0.4500000476837158,
        "tpp_threshold_500_unintended_diff_only": 0.023750007152557373
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.007249981164932251,
        "tpp_threshold_2_intended_diff_only": 0.004999995231628418,
        "tpp_threshold_2_unintended_diff_only": -0.002249985933303833,
        "tpp_threshold_5_total_metric": 0.0020000040531158447,
        "tpp_threshold_5_intended_diff_only": 0.009000003337860107,
        "tpp_threshold_5_unintended_diff_only": 0.006999999284744263,
        "tpp_threshold_10_total_metric": 0.02325001358985901,
        "tpp_threshold_10_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_10_unintended_diff_only": 0.002750009298324585,
        "tpp_threshold_20_total_metric": 0.031750038266181946,
        "tpp_threshold_20_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_20_unintended_diff_only": 0.0032499879598617554,
        "tpp_threshold_50_total_metric": 0.07050000131130219,
        "tpp_threshold_50_intended_diff_only": 0.07700002193450928,
        "tpp_threshold_50_unintended_diff_only": 0.006500020623207092,
        "tpp_threshold_100_total_metric": 0.16300003230571747,
        "tpp_threshold_100_intended_diff_only": 0.1730000376701355,
        "tpp_threshold_100_unintended_diff_only": 0.01000000536441803,
        "tpp_threshold_500_total_metric": 0.4062500447034836,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.0337500125169754
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.012499973177909851,
        "tpp_threshold_2_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_2_unintended_diff_only": 0.0045000165700912476,
        "tpp_threshold_5_total_metric": -0.005249962210655212,
        "tpp_threshold_5_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_5_unintended_diff_only": -0.002749994397163391,
        "tpp_threshold_10_total_metric": 0.014250010251998901,
        "tpp_threshold_10_intended_diff_only": 0.013999998569488525,
        "tpp_threshold_10_unintended_diff_only": -0.000250011682510376,
        "tpp_threshold_20_total_metric": -0.003999948501586914,
        "tpp_threshold_20_intended_diff_only": 0.001000046730041504,
        "tpp_threshold_20_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_50_total_metric": 0.032499998807907104,
        "tpp_threshold_50_intended_diff_only": 0.03200000524520874,
        "tpp_threshold_50_unintended_diff_only": -0.0004999935626983643,
        "tpp_threshold_100_total_metric": 0.07425004243850708,
        "tpp_threshold_100_intended_diff_only": 0.07600003480911255,
        "tpp_threshold_100_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_500_total_metric": 0.4020000249147415,
        "tpp_threshold_500_intended_diff_only": 0.42000001668930054,
        "tpp_threshold_500_unintended_diff_only": 0.01799999177455902
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.019000008702278137,
        "tpp_threshold_2_intended_diff_only": 0.018000006675720215,
        "tpp_threshold_2_unintended_diff_only": -0.0010000020265579224,
        "tpp_threshold_5_total_metric": 0.03500001132488251,
        "tpp_threshold_5_intended_diff_only": 0.0350000262260437,
        "tpp_threshold_5_unintended_diff_only": 1.4901161193847656e-08,
        "tpp_threshold_10_total_metric": 0.03724999725818634,
        "tpp_threshold_10_intended_diff_only": 0.042999982833862305,
        "tpp_threshold_10_unintended_diff_only": 0.005749985575675964,
        "tpp_threshold_20_total_metric": 0.05500002205371857,
        "tpp_threshold_20_intended_diff_only": 0.058000028133392334,
        "tpp_threshold_20_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_50_total_metric": 0.13375000655651093,
        "tpp_threshold_50_intended_diff_only": 0.13899999856948853,
        "tpp_threshold_50_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_100_total_metric": 0.2600000351667404,
        "tpp_threshold_100_intended_diff_only": 0.27000004053115845,
        "tpp_threshold_100_unintended_diff_only": 0.01000000536441803,
        "tpp_threshold_500_total_metric": 0.39225004613399506,
        "tpp_threshold_500_intended_diff_only": 0.4310000538825989,
        "tpp_threshold_500_unintended_diff_only": 0.03875000774860382
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0157499760389328,
        "tpp_threshold_2_intended_diff_only": 0.019999980926513672,
        "tpp_threshold_2_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_5_total_metric": 0.026249960064888,
        "tpp_threshold_5_intended_diff_only": 0.02399998903274536,
        "tpp_threshold_5_unintended_diff_only": -0.002249971032142639,
        "tpp_threshold_10_total_metric": 0.04474996030330658,
        "tpp_threshold_10_intended_diff_only": 0.04899996519088745,
        "tpp_threshold_10_unintended_diff_only": 0.004250004887580872,
        "tpp_threshold_20_total_metric": 0.06349998712539673,
        "tpp_threshold_20_intended_diff_only": 0.0690000057220459,
        "tpp_threshold_20_unintended_diff_only": 0.00550001859664917,
        "tpp_threshold_50_total_metric": 0.15049999952316284,
        "tpp_threshold_50_intended_diff_only": 0.156000018119812,
        "tpp_threshold_50_unintended_diff_only": 0.00550001859664917,
        "tpp_threshold_100_total_metric": 0.2802499681711197,
        "tpp_threshold_100_intended_diff_only": 0.2889999747276306,
        "tpp_threshold_100_unintended_diff_only": 0.008750006556510925,
        "tpp_threshold_500_total_metric": 0.35450002551078796,
        "tpp_threshold_500_intended_diff_only": 0.38200002908706665,
        "tpp_threshold_500_unintended_diff_only": 0.027500003576278687
      }
    }
  }
}