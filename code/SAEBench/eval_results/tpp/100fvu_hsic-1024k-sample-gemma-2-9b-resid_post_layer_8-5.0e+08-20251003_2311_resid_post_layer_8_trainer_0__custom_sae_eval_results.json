{
  "eval_type_id": "tpp",
  "eval_config": {
    "random_seed": 42,
    "dataset_names": [
      "LabHC/bias_in_bios_class_set1",
      "canrager/amazon_reviews_mcauley_1and5"
    ],
    "perform_scr": false,
    "early_stopping_patience": 20,
    "train_set_size": 4000,
    "test_set_size": 1000,
    "context_length": 128,
    "probe_train_batch_size": 16,
    "probe_test_batch_size": 500,
    "probe_epochs": 20,
    "probe_lr": 0.001,
    "probe_l1_penalty": 0.001,
    "sae_batch_size": 125,
    "llm_batch_size": 1,
    "llm_dtype": "torch.bfloat16",
    "lower_vram_usage": false,
    "model_name": "google/gemma-2-9b",
    "n_values": [
      2,
      5,
      10,
      20,
      50,
      100,
      500
    ],
    "column1_vals_lookup": {
      "LabHC/bias_in_bios_class_set1": [
        [
          "professor",
          "nurse"
        ],
        [
          "architect",
          "journalist"
        ],
        [
          "surgeon",
          "psychologist"
        ],
        [
          "attorney",
          "teacher"
        ]
      ],
      "canrager/amazon_reviews_mcauley_1and5": [
        [
          "Books",
          "CDs_and_Vinyl"
        ],
        [
          "Software",
          "Electronics"
        ],
        [
          "Pet_Supplies",
          "Office_Products"
        ],
        [
          "Industrial_and_Scientific",
          "Toys_and_Games"
        ]
      ]
    }
  },
  "eval_id": "fce2198a-67e3-4139-accd-a4b980a1d602",
  "datetime_epoch_millis": 1759808310276,
  "eval_result_metrics": {
    "tpp_metrics": {
      "tpp_threshold_2_total_metric": 0.004100002348423004,
      "tpp_threshold_2_intended_diff_only": 0.002800005674362183,
      "tpp_threshold_2_unintended_diff_only": -0.0012999966740608214,
      "tpp_threshold_5_total_metric": 0.005974987149238586,
      "tpp_threshold_5_intended_diff_only": 0.008099991083145141,
      "tpp_threshold_5_unintended_diff_only": 0.0021250039339065553,
      "tpp_threshold_10_total_metric": 0.010999995470046996,
      "tpp_threshold_10_intended_diff_only": 0.013200002908706664,
      "tpp_threshold_10_unintended_diff_only": 0.002200007438659668,
      "tpp_threshold_20_total_metric": 0.025425010919570924,
      "tpp_threshold_20_intended_diff_only": 0.028300011157989503,
      "tpp_threshold_20_unintended_diff_only": 0.002875000238418579,
      "tpp_threshold_50_total_metric": 0.08020000606775284,
      "tpp_threshold_50_intended_diff_only": 0.0862000048160553,
      "tpp_threshold_50_unintended_diff_only": 0.005999998748302459,
      "tpp_threshold_100_total_metric": 0.1911750018596649,
      "tpp_threshold_100_intended_diff_only": 0.19990000724792478,
      "tpp_threshold_100_unintended_diff_only": 0.008725005388259887,
      "tpp_threshold_500_total_metric": 0.4258250266313553,
      "tpp_threshold_500_intended_diff_only": 0.4474000334739685,
      "tpp_threshold_500_unintended_diff_only": 0.02157500684261322
    }
  },
  "eval_result_details": [
    {
      "dataset_name": "LabHC/bias_in_bios_class_set1_tpp_results",
      "tpp_threshold_2_total_metric": 0.0018500059843063355,
      "tpp_threshold_2_intended_diff_only": 0.003600013256072998,
      "tpp_threshold_2_unintended_diff_only": 0.0017500072717666626,
      "tpp_threshold_5_total_metric": 0.004949980974197387,
      "tpp_threshold_5_intended_diff_only": 0.007799994945526123,
      "tpp_threshold_5_unintended_diff_only": 0.0028500139713287355,
      "tpp_threshold_10_total_metric": 0.011049985885620117,
      "tpp_threshold_10_intended_diff_only": 0.014800000190734863,
      "tpp_threshold_10_unintended_diff_only": 0.0037500143051147463,
      "tpp_threshold_20_total_metric": 0.019450005888938905,
      "tpp_threshold_20_intended_diff_only": 0.024400007724761964,
      "tpp_threshold_20_unintended_diff_only": 0.004950001835823059,
      "tpp_threshold_50_total_metric": 0.05985000431537628,
      "tpp_threshold_50_intended_diff_only": 0.06600000858306884,
      "tpp_threshold_50_unintended_diff_only": 0.006150004267692566,
      "tpp_threshold_100_total_metric": 0.17630000412464142,
      "tpp_threshold_100_intended_diff_only": 0.18260000944137572,
      "tpp_threshold_100_unintended_diff_only": 0.006300005316734314,
      "tpp_threshold_500_total_metric": 0.4549000233411789,
      "tpp_threshold_500_intended_diff_only": 0.46940003633499144,
      "tpp_threshold_500_unintended_diff_only": 0.014500012993812561
    },
    {
      "dataset_name": "canrager/amazon_reviews_mcauley_1and5_tpp_results",
      "tpp_threshold_2_total_metric": 0.006349998712539673,
      "tpp_threshold_2_intended_diff_only": 0.0019999980926513673,
      "tpp_threshold_2_unintended_diff_only": -0.004350000619888305,
      "tpp_threshold_5_total_metric": 0.006999993324279785,
      "tpp_threshold_5_intended_diff_only": 0.00839998722076416,
      "tpp_threshold_5_unintended_diff_only": 0.001399993896484375,
      "tpp_threshold_10_total_metric": 0.010950005054473877,
      "tpp_threshold_10_intended_diff_only": 0.011600005626678466,
      "tpp_threshold_10_unintended_diff_only": 0.0006500005722045899,
      "tpp_threshold_20_total_metric": 0.03140001595020294,
      "tpp_threshold_20_intended_diff_only": 0.03220001459121704,
      "tpp_threshold_20_unintended_diff_only": 0.0007999986410140991,
      "tpp_threshold_50_total_metric": 0.10055000782012939,
      "tpp_threshold_50_intended_diff_only": 0.10640000104904175,
      "tpp_threshold_50_unintended_diff_only": 0.005849993228912354,
      "tpp_threshold_100_total_metric": 0.20604999959468842,
      "tpp_threshold_100_intended_diff_only": 0.21720000505447387,
      "tpp_threshold_100_unintended_diff_only": 0.01115000545978546,
      "tpp_threshold_500_total_metric": 0.3967500299215317,
      "tpp_threshold_500_intended_diff_only": 0.42540003061294557,
      "tpp_threshold_500_unintended_diff_only": 0.02865000069141388
    }
  ],
  "sae_bench_commit_hash": "Unknown",
  "sae_lens_id": "custom_sae",
  "sae_lens_release_id": "100fvu_hsic-1024k-sample-gemma-2-9b-resid_post_layer_8-5.0e+08-20251003_2311_resid_post_layer_8/trainer_0/",
  "sae_lens_version": "5.4.0",
  "sae_cfg_dict": {
    "model_name": "google/gemma-2-9b",
    "d_in": 3584,
    "d_sae": 28672,
    "hook_layer": 8,
    "hook_name": "blocks.8.hook_resid_post",
    "context_size": null,
    "hook_head_index": null,
    "architecture": "topk",
    "apply_b_dec_to_input": null,
    "finetuning_scaling_factor": null,
    "activation_fn_str": "",
    "prepend_bos": true,
    "normalize_activations": "none",
    "dtype": "float32",
    "device": "",
    "dataset_path": "",
    "dataset_trust_remote_code": true,
    "seqpos_slice": [
      null
    ],
    "training_tokens": -100000,
    "sae_lens_training_version": null,
    "neuronpedia_id": null
  },
  "eval_result_unstructured": {
    "LabHC/bias_in_bios_class_set1": {
      "0": {
        "tpp_threshold_2_total_metric": -0.004499971866607666,
        "tpp_threshold_2_intended_diff_only": -0.0029999613761901855,
        "tpp_threshold_2_unintended_diff_only": 0.0015000104904174805,
        "tpp_threshold_5_total_metric": 0.005500003695487976,
        "tpp_threshold_5_intended_diff_only": 0.013000011444091797,
        "tpp_threshold_5_unintended_diff_only": 0.007500007748603821,
        "tpp_threshold_10_total_metric": 0.012749984860420227,
        "tpp_threshold_10_intended_diff_only": 0.018999993801116943,
        "tpp_threshold_10_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_20_total_metric": 0.034750014543533325,
        "tpp_threshold_20_intended_diff_only": 0.04100000858306885,
        "tpp_threshold_20_unintended_diff_only": 0.0062499940395355225,
        "tpp_threshold_50_total_metric": 0.06399998068809509,
        "tpp_threshold_50_intended_diff_only": 0.06999999284744263,
        "tpp_threshold_50_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_100_total_metric": 0.1457500010728836,
        "tpp_threshold_100_intended_diff_only": 0.15299999713897705,
        "tpp_threshold_100_unintended_diff_only": 0.007249996066093445,
        "tpp_threshold_500_total_metric": 0.44325001537799835,
        "tpp_threshold_500_intended_diff_only": 0.4570000171661377,
        "tpp_threshold_500_unintended_diff_only": 0.013750001788139343
      },
      "1": {
        "tpp_threshold_2_total_metric": -0.011749953031539917,
        "tpp_threshold_2_intended_diff_only": -0.007999956607818604,
        "tpp_threshold_2_unintended_diff_only": 0.0037499964237213135,
        "tpp_threshold_5_total_metric": -0.00849999487400055,
        "tpp_threshold_5_intended_diff_only": -0.004999995231628418,
        "tpp_threshold_5_unintended_diff_only": 0.0034999996423721313,
        "tpp_threshold_10_total_metric": 0.0014999955892562866,
        "tpp_threshold_10_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_10_unintended_diff_only": 0.002500012516975403,
        "tpp_threshold_20_total_metric": -0.007249966263771057,
        "tpp_threshold_20_intended_diff_only": -0.001999974250793457,
        "tpp_threshold_20_unintended_diff_only": 0.0052499920129776,
        "tpp_threshold_50_total_metric": 0.023250028491020203,
        "tpp_threshold_50_intended_diff_only": 0.026000022888183594,
        "tpp_threshold_50_unintended_diff_only": 0.002749994397163391,
        "tpp_threshold_100_total_metric": 0.06525002419948578,
        "tpp_threshold_100_intended_diff_only": 0.07200002670288086,
        "tpp_threshold_100_unintended_diff_only": 0.006750002503395081,
        "tpp_threshold_500_total_metric": 0.4427499920129776,
        "tpp_threshold_500_intended_diff_only": 0.4570000171661377,
        "tpp_threshold_500_unintended_diff_only": 0.014250025153160095
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.0017500072717666626,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": 0.002250000834465027,
        "tpp_threshold_5_total_metric": 0.0029999613761901855,
        "tpp_threshold_5_intended_diff_only": 0.0059999823570251465,
        "tpp_threshold_5_unintended_diff_only": 0.003000020980834961,
        "tpp_threshold_10_total_metric": 0.00824996829032898,
        "tpp_threshold_10_intended_diff_only": 0.014999985694885254,
        "tpp_threshold_10_unintended_diff_only": 0.006750017404556274,
        "tpp_threshold_20_total_metric": 0.015000015497207642,
        "tpp_threshold_20_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_20_unintended_diff_only": 0.006000012159347534,
        "tpp_threshold_50_total_metric": 0.06175002455711365,
        "tpp_threshold_50_intended_diff_only": 0.07200002670288086,
        "tpp_threshold_50_unintended_diff_only": 0.010250002145767212,
        "tpp_threshold_100_total_metric": 0.15450002253055573,
        "tpp_threshold_100_intended_diff_only": 0.1640000343322754,
        "tpp_threshold_100_unintended_diff_only": 0.009500011801719666,
        "tpp_threshold_500_total_metric": 0.4395000487565994,
        "tpp_threshold_500_intended_diff_only": 0.4540000557899475,
        "tpp_threshold_500_unintended_diff_only": 0.014500007033348083
      },
      "6": {
        "tpp_threshold_2_total_metric": 0.0017499327659606934,
        "tpp_threshold_2_intended_diff_only": 0.003999948501586914,
        "tpp_threshold_2_unintended_diff_only": 0.0022500157356262207,
        "tpp_threshold_5_total_metric": 0.0024999231100082397,
        "tpp_threshold_5_intended_diff_only": 0.003999948501586914,
        "tpp_threshold_5_unintended_diff_only": 0.0015000253915786743,
        "tpp_threshold_10_total_metric": 0.00349995493888855,
        "tpp_threshold_10_intended_diff_only": 0.006999969482421875,
        "tpp_threshold_10_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_20_total_metric": 0.011749953031539917,
        "tpp_threshold_20_intended_diff_only": 0.01699995994567871,
        "tpp_threshold_20_unintended_diff_only": 0.005250006914138794,
        "tpp_threshold_50_total_metric": 0.05874998867511749,
        "tpp_threshold_50_intended_diff_only": 0.06499999761581421,
        "tpp_threshold_50_unintended_diff_only": 0.006250008940696716,
        "tpp_threshold_100_total_metric": 0.3427499532699585,
        "tpp_threshold_100_intended_diff_only": 0.3489999771118164,
        "tpp_threshold_100_unintended_diff_only": 0.00625002384185791,
        "tpp_threshold_500_total_metric": 0.4817500114440918,
        "tpp_threshold_500_intended_diff_only": 0.48900002241134644,
        "tpp_threshold_500_unintended_diff_only": 0.007250010967254639
      },
      "9": {
        "tpp_threshold_2_total_metric": 0.022000014781951904,
        "tpp_threshold_2_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_2_unintended_diff_only": -0.0009999871253967285,
        "tpp_threshold_5_total_metric": 0.022250011563301086,
        "tpp_threshold_5_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_5_unintended_diff_only": -0.0012499839067459106,
        "tpp_threshold_10_total_metric": 0.029250025749206543,
        "tpp_threshold_10_intended_diff_only": 0.029000043869018555,
        "tpp_threshold_10_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_20_total_metric": 0.04300001263618469,
        "tpp_threshold_20_intended_diff_only": 0.04500001668930054,
        "tpp_threshold_20_unintended_diff_only": 0.0020000040531158447,
        "tpp_threshold_50_total_metric": 0.09149999916553497,
        "tpp_threshold_50_intended_diff_only": 0.09700000286102295,
        "tpp_threshold_50_unintended_diff_only": 0.005500003695487976,
        "tpp_threshold_100_total_metric": 0.1732500195503235,
        "tpp_threshold_100_intended_diff_only": 0.17500001192092896,
        "tpp_threshold_100_unintended_diff_only": 0.0017499923706054688,
        "tpp_threshold_500_total_metric": 0.4672500491142273,
        "tpp_threshold_500_intended_diff_only": 0.49000006914138794,
        "tpp_threshold_500_unintended_diff_only": 0.022750020027160645
      }
    },
    "canrager/amazon_reviews_mcauley_1and5": {
      "1": {
        "tpp_threshold_2_total_metric": 0.016500011086463928,
        "tpp_threshold_2_intended_diff_only": 0.0040000081062316895,
        "tpp_threshold_2_unintended_diff_only": -0.012500002980232239,
        "tpp_threshold_5_total_metric": -0.0032500028610229492,
        "tpp_threshold_5_intended_diff_only": 0.0009999871253967285,
        "tpp_threshold_5_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_10_total_metric": 0.012750029563903809,
        "tpp_threshold_10_intended_diff_only": 0.012000024318695068,
        "tpp_threshold_10_unintended_diff_only": -0.0007500052452087402,
        "tpp_threshold_20_total_metric": 0.020250052213668823,
        "tpp_threshold_20_intended_diff_only": 0.020000040531158447,
        "tpp_threshold_20_unintended_diff_only": -0.000250011682510376,
        "tpp_threshold_50_total_metric": 0.03799998760223389,
        "tpp_threshold_50_intended_diff_only": 0.046999990940093994,
        "tpp_threshold_50_unintended_diff_only": 0.009000003337860107,
        "tpp_threshold_100_total_metric": 0.10175000131130219,
        "tpp_threshold_100_intended_diff_only": 0.11500000953674316,
        "tpp_threshold_100_unintended_diff_only": 0.013250008225440979,
        "tpp_threshold_500_total_metric": 0.41225002706050873,
        "tpp_threshold_500_intended_diff_only": 0.4520000219345093,
        "tpp_threshold_500_unintended_diff_only": 0.03974999487400055
      },
      "2": {
        "tpp_threshold_2_total_metric": 0.014250054955482483,
        "tpp_threshold_2_intended_diff_only": 0.006000041961669922,
        "tpp_threshold_2_unintended_diff_only": -0.008250012993812561,
        "tpp_threshold_5_total_metric": 0.021250039339065552,
        "tpp_threshold_5_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_5_unintended_diff_only": -0.000250011682510376,
        "tpp_threshold_10_total_metric": 0.021250039339065552,
        "tpp_threshold_10_intended_diff_only": 0.021000027656555176,
        "tpp_threshold_10_unintended_diff_only": -0.000250011682510376,
        "tpp_threshold_20_total_metric": 0.04300004243850708,
        "tpp_threshold_20_intended_diff_only": 0.04400002956390381,
        "tpp_threshold_20_unintended_diff_only": 0.0009999871253967285,
        "tpp_threshold_50_total_metric": 0.13250002264976501,
        "tpp_threshold_50_intended_diff_only": 0.1340000033378601,
        "tpp_threshold_50_unintended_diff_only": 0.0014999806880950928,
        "tpp_threshold_100_total_metric": 0.2782500088214874,
        "tpp_threshold_100_intended_diff_only": 0.28600001335144043,
        "tpp_threshold_100_unintended_diff_only": 0.007750004529953003,
        "tpp_threshold_500_total_metric": 0.41800007224082947,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.021999984979629517
      },
      "3": {
        "tpp_threshold_2_total_metric": -0.005500048398971558,
        "tpp_threshold_2_intended_diff_only": -0.0020000338554382324,
        "tpp_threshold_2_unintended_diff_only": 0.003500014543533325,
        "tpp_threshold_5_total_metric": -0.003750041127204895,
        "tpp_threshold_5_intended_diff_only": -0.006000041961669922,
        "tpp_threshold_5_unintended_diff_only": -0.002250000834465027,
        "tpp_threshold_10_total_metric": -0.007250040769577026,
        "tpp_threshold_10_intended_diff_only": -0.003000020980834961,
        "tpp_threshold_10_unintended_diff_only": 0.004250019788742065,
        "tpp_threshold_20_total_metric": -0.0007500648498535156,
        "tpp_threshold_20_intended_diff_only": -0.001000046730041504,
        "tpp_threshold_20_unintended_diff_only": -0.0002499818801879883,
        "tpp_threshold_50_total_metric": 0.027999982237815857,
        "tpp_threshold_50_intended_diff_only": 0.03700000047683716,
        "tpp_threshold_50_unintended_diff_only": 0.009000018239021301,
        "tpp_threshold_100_total_metric": 0.09799998998641968,
        "tpp_threshold_100_intended_diff_only": 0.11100000143051147,
        "tpp_threshold_100_unintended_diff_only": 0.013000011444091797,
        "tpp_threshold_500_total_metric": 0.38099996745586395,
        "tpp_threshold_500_intended_diff_only": 0.4129999876022339,
        "tpp_threshold_500_unintended_diff_only": 0.032000020146369934
      },
      "5": {
        "tpp_threshold_2_total_metric": 0.012749999761581421,
        "tpp_threshold_2_intended_diff_only": 0.009999990463256836,
        "tpp_threshold_2_unintended_diff_only": -0.002750009298324585,
        "tpp_threshold_5_total_metric": 0.018750011920928955,
        "tpp_threshold_5_intended_diff_only": 0.023000001907348633,
        "tpp_threshold_5_unintended_diff_only": 0.004249989986419678,
        "tpp_threshold_10_total_metric": 0.03700001537799835,
        "tpp_threshold_10_intended_diff_only": 0.04000002145767212,
        "tpp_threshold_10_unintended_diff_only": 0.003000006079673767,
        "tpp_threshold_20_total_metric": 0.06550005078315735,
        "tpp_threshold_20_intended_diff_only": 0.07100003957748413,
        "tpp_threshold_20_unintended_diff_only": 0.005499988794326782,
        "tpp_threshold_50_total_metric": 0.18875004351139069,
        "tpp_threshold_50_intended_diff_only": 0.19300001859664917,
        "tpp_threshold_50_unintended_diff_only": 0.004249975085258484,
        "tpp_threshold_100_total_metric": 0.33425000309944153,
        "tpp_threshold_100_intended_diff_only": 0.35100001096725464,
        "tpp_threshold_100_unintended_diff_only": 0.01675000786781311,
        "tpp_threshold_500_total_metric": 0.4047500491142273,
        "tpp_threshold_500_intended_diff_only": 0.440000057220459,
        "tpp_threshold_500_unintended_diff_only": 0.03525000810623169
      },
      "6": {
        "tpp_threshold_2_total_metric": -0.00625002384185791,
        "tpp_threshold_2_intended_diff_only": -0.008000016212463379,
        "tpp_threshold_2_unintended_diff_only": -0.0017499923706054688,
        "tpp_threshold_5_total_metric": 0.001999959349632263,
        "tpp_threshold_5_intended_diff_only": 0.0029999613761901855,
        "tpp_threshold_5_unintended_diff_only": 0.0010000020265579224,
        "tpp_threshold_10_total_metric": -0.009000018239021301,
        "tpp_threshold_10_intended_diff_only": -0.012000024318695068,
        "tpp_threshold_10_unintended_diff_only": -0.003000006079673767,
        "tpp_threshold_20_total_metric": 0.028999999165534973,
        "tpp_threshold_20_intended_diff_only": 0.027000010013580322,
        "tpp_threshold_20_unintended_diff_only": -0.001999989151954651,
        "tpp_threshold_50_total_metric": 0.11550000309944153,
        "tpp_threshold_50_intended_diff_only": 0.12099999189376831,
        "tpp_threshold_50_unintended_diff_only": 0.005499988794326782,
        "tpp_threshold_100_total_metric": 0.21799999475479126,
        "tpp_threshold_100_intended_diff_only": 0.22299998998641968,
        "tpp_threshold_100_unintended_diff_only": 0.004999995231628418,
        "tpp_threshold_500_total_metric": 0.36775003373622894,
        "tpp_threshold_500_intended_diff_only": 0.38200002908706665,
        "tpp_threshold_500_unintended_diff_only": 0.014249995350837708
      }
    }
  }
}